/*!
    *
    * Wijmo Library 5.20213.824
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(e){var t;(function(t){var i="wj-column-selector",o=function(){function Selector(t,i){this._col=null;this._grid=null;this._isFixedCol=!1;this._isBound=!1;this._showCheckAll=!0;this._clickBnd=this._click.bind(this);this._mousedownBnd=this._mousedown.bind(this);this.columnChanging=new e.Event;this.columnChanged=new e.Event;this.itemChecked=new e.Event;this._initialize();this.column=this._getColumn(t);e.copy(this,i)}Object.defineProperty(Selector.prototype,"column",{get:function(){return this._col},set:function(t){if((t=this._getColumn(t))!=this._col&&this.onColumnChanging(new e.CancelEventArgs)){var i=this._grid;if(i){var o=i.hostElement;i.formatItem.removeHandler(this._formatItem,this);i.removeEventListener(o,"click",this._clickBnd);i.removeEventListener(o,"mousedown",this._mousedownBnd)}var n=this._col=e.asType(t,e.grid.Column,!0);this._grid=i=n?n.grid:null;this._isFixedCol=!!i&&i.columns.indexOf(n)<0;n&&!this._isBound&&(n.allowMerging=!1);i&&!this._isBound&&(i.selectionMode=e.grid.SelectionMode.Cell);if(i){o=i.hostElement;i.formatItem.addHandler(this._formatItem,this);i.addEventListener(o,"click",this._clickBnd,!0);i.addEventListener(o,"mousedown",this._mousedownBnd,!0)}this.onColumnChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Selector.prototype,"showCheckAll",{get:function(){return this._showCheckAll},set:function(t){if(t!=this._showCheckAll){this._showCheckAll=e.asBoolean(t);this._grid&&this._grid.invalidate()}},enumerable:!0,configurable:!0});Selector.prototype.onColumnChanging=function(e){this.columnChanging.raise(this,e);return!e.cancel};Selector.prototype.onColumnChanged=function(e){this.columnChanged.raise(this,e)};Selector.prototype.onItemChecked=function(e){this.itemChecked.raise(this,e)};Selector.prototype._initialize=function(){};Selector.prototype._click=function(t){if(!t.defaultPrevented&&t.target instanceof HTMLElement){var o=this._grid,n=this._col,s=t.target,r=o.hitTest(s);if(n&&r&&r.getColumn()==n){if(s instanceof HTMLInputElement&&e.hasClass(s,i)){var l=void 0,c=r.panel.rows,a=c[r.range.topRow];if(c==o.columnHeaders.rows){l=new e.grid.CellRange(0,0,o.rows.length-1,0);if(this._isBound){var d=o.selection;d.col=d.col2=n.index;o.select(d)}}else l=this._isGroupRow(a)?a.getCellRange():r.range;if(l.isValid){this._setRangeChecked(s.checked,l);this.onItemChecked()}o.invalidate();t.preventDefault();return}if(e.hasClass(s,"wj-cell")&&o.bigCheckboxes&&this._isBound&&(this._isFixedCol||this._isGroupRow(r.getRow()))){var h=s.querySelector("input."+i);if(h instanceof HTMLInputElement){h.click();t.preventDefault()}}}}};Selector.prototype._mousedown=function(t){var i=this._grid,o=this._col,n=i.editableCollectionView;if(this._isBound&&o&&n&&n.currentEditItem){var s=i.hitTest(t);if(s.getColumn()==o&&this._isGroupRow(s.getRow())){var r=e.closestClass(t.target,"wj-column-selector-group");r instanceof HTMLInputElement&&r.click()}}};Selector.prototype._isGroupRow=function(t){return t instanceof e.grid.GroupRow&&(!this._grid.childItemsPath||t.getCellRange().rowSpan>1)};Selector.prototype._getRowChecked=function(e,t){void 0===t&&(t=e);for(var i=0,o=0,n=this._col._binding,s=e;s<=t&&(!i||!o);s++){var r=this._grid.rows[s],l=r.dataItem;l&&!this._isGroupRow(r)&&((this._isBound?n.getValue(l):r.isSelected)?i++:o++)}return!(!i||o)||!(o&&!i)&&null};Selector.prototype._setRangeChecked=function(t,i){var o=this,n=this._grid,s=n.rows,r=this._col,l=r?r._binding:null,c=n.selection,a=this._isBound?n.editableCollectionView:null;if(!this._isBound||!n.isReadOnly&&a&&l){var d=!1;if(a){var h=!0;a instanceof e.collections.CollectionView&&!a.refreshOnEdit&&(h=!1);if(h){d=!0;a.beginUpdate()}}n.deferUpdate((function(){for(var c=i.bottomRow;c>=i.topRow;c--){var d=s[c],h=d.dataItem;if(h)if(o._isGroupRow(d))n.childItemsPath&&!o._isBound&&(d.isSelected=t);else if(o._isBound){if(h[r.binding]!=t){a&&a.editItem(h);var u=new e.grid.CellRange(c,r.index),g=new e.grid.CellEditEndingEventArgs(n.cells,u,h[r.binding]);if(n.onCellEditEnding(g)){l.setValue(h,t);n.onCellEditEnded(g)}}}else d.isSelected=t}}));if(a){a.commitEdit();d&&a.endUpdate();n.selection=c}}};Selector.prototype._formatItem=function(t,o){var n=o.getColumn(),s=t.editRange;if(n&&n==this._col&&(!s||!s.contains(o.row,o.col))&&o.panel.rows!=t.columnFooters.rows){var r=o.getRow(),l=o.cell,c="",a=void 0;if(o.panel.rows==t.columnHeaders.rows){if(this._showCheckAll&&o.range.bottomRow==o.panel.rows.length-1){a=this._getRowChecked(0,t.rows.length-1);c=i+" wj-column-selector-group"}}else if(this._isGroupRow(r)){var d=r.getCellRange();a=this._getRowChecked(d.row,d.row2);c=i+" wj-column-selector-group"}else if(r.dataItem&&!this._isBound){a=this._getRowChecked(o.row);c=i}if(c){if(this._isFixedCol||this._isBound&&this._isGroupRow(r)&&n.aggregate&&n.index>t.columns.firstVisibleIndex){var h=l.querySelector("."+e.grid.CellFactory._WJC_COLLAPSE);l.textContent="";h&&l.appendChild(h)}var u=e.createElement('<label><input type="checkbox" class="'+c+'" tabindex="-1"><span></span></label>'),g=u.querySelector("input");e.setChecked(g,a);if(this._isBound&&(n.isReadOnly||t.selectionMode==e.grid.SelectionMode.None)){g.disabled=!0;g.style.cursor="default"}l.insertBefore(u,l.firstChild)}}};Selector.prototype._getColumn=function(t){if(t instanceof e.grid.FlexGrid){var i=t,o=i.rowHeaders.columns;t=i.headersVisibility&e.grid.HeadersVisibility.Row&&o.length?o[0]:i.columns[0]}this._grid&&(e.isString(t)||e.isNumber(t))&&(t=this._grid.getColumn(t));return t instanceof e.grid.Column?t:null};return Selector}();t.Selector=o;var n=function(t){__extends(BooleanChecker,t);function BooleanChecker(e,i){return t.call(this,e,i)||this}BooleanChecker.prototype.onColumnChanged=function(i){var o=this.column,n=o?o.dataType:null;e.assert(!o||null==n||n==e.DataType.Boolean,"BooleanChecker should be bound to boolean columns");t.prototype.onColumnChanged.call(this,i)};BooleanChecker.prototype._initialize=function(){this._isBound=!0};return BooleanChecker}(o);t.BooleanChecker=n})((t=e.grid||(e.grid={})).selector||(t.selector={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.selector||(t.selector={}),e._registerModule("wijmo.grid.selector",e.grid.selector)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));