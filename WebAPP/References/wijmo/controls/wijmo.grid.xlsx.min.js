/*!
    *
    * Wijmo Library 5.20213.824
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)t.hasOwnProperty(l)&&(e[l]=t[l])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(e){!function(t){!function(t){t.softDetail=function softDetail(){return e._getModule("wijmo.grid.detail")};t.softMultiRow=function softMultiRow(){return e._getModule("wijmo.grid.multirow")};t.softTransposed=function softTransposed(){return e._getModule("wijmo.grid.transposed")};t.softTransposedMultiRow=function softTransposedMultiRow(){return e._getModule("wijmo.grid.transposedmultirow")}}(t.xlsx||(t.xlsx={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var l=function(){function FlexGridXlsxConverter(){}FlexGridXlsxConverter.save=function(t,l,o){var r=new e.xlsx.Workbook;this._saveFlexGridToWorkbook(r,t,l,!1,null);o&&r.save(o);return r};FlexGridXlsxConverter.saveAsync=function(t,l,o,r,n,s,i){var a=this,u=new e.xlsx.Workbook;if(!i){this._saveFlexGridToWorkbook(u,t,l,!1,null);o?u.saveAsync(o,(function(t){e.isFunction(r)&&r(t,u)}),n,null):e.isFunction(r)&&r(null,u);return u}var d=null!=o;this.cancelAsync((function(){var i,c=[t.collectionView&&t.collectionView.collectionChanged,t.columns&&t.columns.collectionChanged,t.rows&&t.rows.collectionChanged,t.resizedColumn,t.resizedRow],removeHandlers=function(){return c.forEach((function(e){e&&e.removeHandler(restart)}))},restart=function(){a._cs&&a._cs.cancel(!1);clearTimeout(i);i=setTimeout((function(){removeHandlers();u=null;a.saveAsync(t,l,o,r,n,s)}),100)},finish=function(){clearTimeout(i);a._cs=null;removeHandlers()};a._cs=new e.xlsx._SyncPromise(null,finish);c.forEach((function(e){e&&e.addHandler(restart)}));a._saveFlexGridToWorkbook(u,t,l,!0,a._cs,(function(t){e.isFunction(s)&&s(d?Math.round(e.xlsx._map(t,0,100,0,50)):t)})).then((function(){if(o){u._externalCancellation=function(){return a._cs};u.saveAsync(o,(function(t){finish();e.isFunction(r)&&r(t,u)}),(function(t){finish();e.isFunction(n)&&n(t)}),(function(t){e.isFunction(s)&&s(Math.round(e.xlsx._map(t,0,100,51,100)))}))}else{finish();e.isFunction(s)&&s(100);e.isFunction(r)&&r(null,u)}}),(function(e){finish();throw e}))}));return null};FlexGridXlsxConverter.cancelAsync=function(t){var l=this;if(this._cs){this._cs.cancel();setTimeout((function(){l._cs=null;e.isFunction(t)&&t()}),100)}else e.isFunction(t)&&t()};FlexGridXlsxConverter.load=function(t,l,o){var r=this;if(l instanceof Blob)_blobToBuffer(l,(function(n){l=null;var s=new e.xlsx.Workbook;s.load(n);n=null;t.deferUpdate((function(){r._loadToFlexGrid(t,s,o);s=null}))}));else if(l instanceof e.xlsx.Workbook)t.deferUpdate((function(){r._loadToFlexGrid(t,l,o);l=null}));else{if(!(l instanceof ArrayBuffer||e.isString(l)))throw"Invalid workbook.";var n=new e.xlsx.Workbook;n.load(l);l=null;t.deferUpdate((function(){r._loadToFlexGrid(t,n,o);n=null}))}};FlexGridXlsxConverter.loadAsync=function(t,l,o,r,n){var s=this;if(l instanceof Blob)_blobToBuffer(l,(function(i){l=null;var a=new e.xlsx.Workbook;a.loadAsync(i,(function(){i=null;t.deferUpdate((function(){s._loadToFlexGrid(t,a,o);r&&r(a);a=null}))}),n)}));else if(l instanceof e.xlsx.Workbook)t.deferUpdate((function(){s._loadToFlexGrid(t,l,o);r&&r(l);l=null}));else{if(!(l instanceof ArrayBuffer||e.isString(l)))throw"Invalid workbook.";var i=new e.xlsx.Workbook;i.loadAsync(l,(function(){l=null;t.deferUpdate((function(){s._loadToFlexGrid(t,i,o);r&&r(i);i=null}))}),n)}};FlexGridXlsxConverter._saveFlexGridToWorkbook=function(l,r,s,i,a,u){var d=new e.xlsx._SyncPromise(a),c=new e.xlsx.WorkSheet,f=!s||null==s.includeColumnHeaders||s.includeColumnHeaders,h=!(!s||null==s.includeRowHeaders)&&s.includeRowHeaders,x=o.Cache,p=s?s.includeColumns:null,g=s?s.formatItem:null,m=[];s&&(x=!1===e.asBoolean(s.includeCellStyles,!0)?o.None:!1===e.asBoolean(s.quickCellStyles,!0)?o.Regular:o.Cache);var v=x===o.Cache?new n(500):null;null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style);var w,_=r.wj_sheetInfo;c.name=s?s.sheetName:"";c.visible=!s||!1!==s.sheetVisible;if(_&&_.tables&&_.tables.length>0)for(var C=0;C<_.tables.length;C++)c.tables.push(_.tables[C]);if(!_&&(x!==o.None||g)){(w=document.createElement("div")).style.visibility="hidden";w.setAttribute(e.grid.FlexGrid._WJS_MEASURE,"true");r.hostElement.appendChild(w)}var y=h?r.rowHeaders.columns.length:0,b=this._getPerRowColumnsSettings(r,h?[r.topLeftCells,r.columnHeaders]:[r.columnHeaders]),T=b.cols,S=t.softMultiRow()&&r instanceof t.softMultiRow().MultiRow?this._getPerRowColumnsSettings(r,h?[r.rowHeaders,r.cells]:[r.cells],r.rowsPerItem).cols:null,F=T.length,k=[[r.topLeftCells,r.columnHeaders],[r.rowHeaders,r.cells],[r.bottomLeftCells,r.columnFooters]];f||k.shift();var R=k.map((function(e){return e[1].rows.length})).reduce((function(e,t){return e+t}));T.length&&T[0].forEach((function(t,l){var o=b.bndCols[0][l];if(!(l>=y&&p)||p(o)){var r=new e.xlsx.WorkbookColumn;r._deserialize(t);c._addWorkbookColumn(r)}}));this._saveContentToWorksheet(a,i,Date.now(),0,{panels:k,panelIdx:0,globRowIdx:0,rowsOffset:0,totalRows:R},r,c,h,(function(t){return t==e.grid.CellType.Cell&&S?S:T}),x,w,m,v,p,g,(function(e){u(Math.round(e/R*100))}),(function(){var t=new e.xlsx.WorkbookFrozenPane;t.rows=f?r.frozenRows+F:r.frozenRows;t.columns=h?r.frozenColumns+y:r.frozenColumns;c.frozenPane=t;l._addWorkSheet(c);if(!_&&(x!==o.None||g)){r.hostElement.removeChild(w);m.forEach((function(e){return e.forEach((function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}))}))}v&&v.clear();l.activeWorksheet=s?s.activeWorksheet:null;d.resolve()}));return d};FlexGridXlsxConverter._saveContentToWorksheet=function(t,l,o,r,n,s,i,a,u,d,c,f,h,x,p,g,m){for(var v=this,w=d?20:200,_loop_1=function(C){if(t&&t.cancelled)return{value:void 0};if(l&&C-r>w&&Date.now()-o>100){setTimeout((function(){if(!t||!t.cancelled){g(C);v._saveContentToWorksheet(t,l,Date.now(),C,n,s,i,a,u,d,c,f,h,x,p,g,m)}}),0);return{value:void 0}}for(;C-n.rowsOffset>=n.panels[n.panelIdx][1].rows.length;){n.rowsOffset+=n.panels[n.panelIdx][1].rows.length;n.panelIdx++}var y=n.panels[n.panelIdx],b=y[0],T=y[1],S=C-n.rowsOffset,F=T.rows[S];if(T.cellType!==e.grid.CellType.Cell&&F.renderSize<=0||F instanceof e.grid._NewRowTemplate)return"continue";var k=0,R={},W=new e.xlsx.WorkbookRow,G=F instanceof e.grid.GroupRow,A=0;T.cellType===e.grid.CellType.Cell&&(G?A=F.level:s.rows.maxGroupLevel>-1&&(A=s.rows.maxGroupLevel+1));var B=u(T.cellType);a&&(k=_._parseFlexGridRowToSheetRow(b,R,S,0,B,d,c,f,h,G,A,x,p));_._parseFlexGridRowToSheetRow(T,R,S,k,B,d,c,f,h,G,A,x,p);if(R.cells.length>0){W._deserialize(R);i._addWorkbookRow(W,n.globRowIdx)}n.globRowIdx++},_=this,C=r;C<n.totalRows;C++){var y=_loop_1(C);if("object"==typeof y)return y.value}e.isFunction(m)&&m()};FlexGridXlsxConverter._loadToFlexGrid=function(l,o,r){if(t.softTransposedMultiRow()&&l instanceof t.softTransposedMultiRow().TransposedMultiRow)throw"Not supported.";r=r||{};var n,s=null!=l.wj_sheetInfo,i={},a=[],u=[],d={};l.itemsSource=null;l.columns.clear();l.columnHeaders.rows.clear();l.rows.clear();l.frozenColumns=0;l.frozenRows=0;var c=null==r.sheetIndex||isNaN(r.sheetIndex)?0:r.sheetIndex;if(c<0||c>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=r.sheetName)for(var f=0;f<o.sheets.length;f++)if(r.sheetName===o.sheets[f].name){n=o.sheets[f];break}if(null!=(n=n||o.sheets[c]).rows){for(var h=this._getColumnCount(n.rows),x=this._getRowCount(n.rows,h),p=n.columns,g=0;g<h;g++){l.columns.push(new e.grid.Column);if(p[g]){isNaN(+p[g].width)||(l.columns[g].width=+p[g].width);p[g].visible||null==p[g].visible||(l.columns[g].visible=!!p[g].visible);p[g].style&&p[g].style.wordWrap&&(l.columns[g].wordWrap=p[g].style.wordWrap)}}var m,v=(null==r.includeColumnHeaders||r.includeColumnHeaders)&&n.rows.length>0,w=v?this._getColumnHeadersHeight(n):0,_=!1,C=[],y=n.frozenPane&&n.frozenPane.rows,b=n.frozenPane&&n.frozenPane.columns;y=e.isNumber(y)&&!isNaN(y)?y:null;b=e.isNumber(b)&&!isNaN(b)?b:null;for(var T=w;T<x;T++){var S=!1,F=null,k=n.rows[T];if(k)for(var R=T+1;R<n.rows.length;){var W=n.rows[R];if(W){(isNaN(k.groupLevel)&&!isNaN(W.groupLevel)||!isNaN(k.groupLevel)&&k.groupLevel<W.groupLevel)&&(S=!0);break}R++}if(S&&!n.summaryBelow){m&&(m.isCollapsed=_);(m=new e.grid.GroupRow).isReadOnly=!1;_=null!=k.collapsed&&k.collapsed;m.level=isNaN(k.groupLevel)?0:k.groupLevel;d[m.level]=_;this._checkParentCollapsed(d,m.level)&&m._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);l.rows.push(m)}else{var G=new e.grid.Row;k&&this._checkParentCollapsed(d,k.groupLevel)&&G._setFlag(e.grid.RowColFlags.ParentCollapsed,!0);l.rows.push(G)}k&&k.height&&!isNaN(k.height)&&(l.rows[T-w].height=k.height);for(g=0;g<h;g++)if(k){var A=k.cells[g],B=A?A.formula:null;B&&"="!==B[0]&&(B="="+B);if(A&&A.textRuns&&A.textRuns.length>0){l.rows[T-w].isContentHtml=!0;l.setCellData(T-w,g,this._parseTextRunsToHTML(A.textRuns))}else l.setCellData(T-w,g,B&&s?B:this._getItemValue(A));S||this._setColumn(C,g,A);var N=T*h+g,D=A?A.style:null;if(D){F=null==F?!!D.wordWrap:F&&!!D.wordWrap;if(s){var I=e.xlsx.Workbook._parseExcelFormat(A),M=void 0;if(D.hAlign)M=e.xlsx.Workbook._parseHAlignToString(e.asEnum(D.hAlign,e.xlsx.HAlign));else switch(this._getItemType(A)){case e.DataType.Number:M="right";break;case e.DataType.Boolean:M="center";break;default:M=I&&0===I.search(/[n,c,p]/i)?"right":"left"}i[N]={fontWeight:D.font&&D.font.bold?"bold":"none",fontStyle:D.font&&D.font.italic?"italic":"none",textDecoration:D.font&&D.font.underline?"underline":"none",textAlign:M,fontFamily:D.font&&D.font.family?D.font.family:"",fontSize:D.font&&D.font.size?D.font.size+"px":"",color:D.font&&D.font.color?D.font.color:"",backgroundColor:D.fill&&D.fill.color?D.fill.color:"",whiteSpace:D.wordWrap?"pre-wrap":"normal",format:I};if(D.borders){if(D.borders.left){this._parseBorderStyle(D.borders.left.style,"Left",i[N]);i[N].borderLeftColor=D.borders.left.color}if(D.borders.right){this._parseBorderStyle(D.borders.right.style,"Right",i[N]);i[N].borderRightColor=D.borders.right.color}if(D.borders.top){this._parseBorderStyle(D.borders.top.style,"Top",i[N]);i[N].borderTopColor=D.borders.top.color}if(D.borders.bottom){this._parseBorderStyle(D.borders.bottom.style,"Bottom",i[N]);i[N].borderBottomColor=D.borders.bottom.color}}if(D.fill&&D.fill.color){var E=i[N],X=D.borders,H=D.fill.color;if(X){X.left&&X.left.color||(E.borderLeftColor=H);X.right&&X.right.color||g===b-1||(E.borderRightColor=H);X.top&&X.top.color||(E.borderTopColor=H);X.bottom&&X.bottom.color||T===y-1||(E.borderBottomColor=H)}else{E.borderLeftColor=H;g!==b-1&&(E.borderRightColor=H);E.borderTopColor=H;T!==y-1&&(E.borderBottomColor=H)}}D.font&&-1===u.indexOf(D.font.family)&&u.push(D.font.family)}}s&&A&&e.isNumber(A.rowSpan)&&A.rowSpan>0&&e.isNumber(A.colSpan)&&A.colSpan>0&&(A.rowSpan>1||A.colSpan>1)&&a.push(new e.grid.CellRange(T,g,T+A.rowSpan-1,g+A.colSpan-1))}if(k){this._checkParentCollapsed(d,k.groupLevel)||k.visible||null==k.visible||(l.rows[T-w].visible=k.visible);l.rows[T-w].wordWrap=!!k.style&&!!k.style.wordWrap||!!F}}m&&(m.isCollapsed=_);null!=b&&(l.frozenColumns=b);null!=y&&(l.frozenRows=v&&y>0?y-1:y);for(g=0;g<l.columnHeaders.columns.length;g++){var z=C[g],O=l.columns[g];O.isRequired=!1;if(z){z.dataType===e.DataType.Boolean&&(O.dataType=z.dataType);O.format=z.format;O.align=z.hAlign;O.wordWrap=O.wordWrap||!!z.wordWrap}}for(f=0;f<Math.max(w,1);f++)l.columnHeaders.rows.push(new e.grid.Row);for(f=0;f<w;f++)for(var j=0;j<l.columnHeaders.columns.length;j++){var L=n.rows[f]?n.rows[f].cells[j]:null,P=L&&null!=L.value?L.value:"",V=l.columnHeaders.columns[j];if(P){var U=e.xlsx.Workbook._parseExcelFormat(L);P=e.Globalize.format(P,U)}V.header=V.header||P;l.columnHeaders.setCellData(f,j,P)}if(s){var q=null==r.sheetVisible||r.sheetVisible;l.wj_sheetInfo.name=n.name;l.wj_sheetInfo.visible=!0===q||!1!==n.visible;l.wj_sheetInfo.styledCells=i;l.wj_sheetInfo.mergedRanges=a;l.wj_sheetInfo.fonts=u;l.wj_sheetInfo.tables=n.tables}}};FlexGridXlsxConverter._getColumnHeadersHeight=function(e){var t;if(!e||!(t=e.rows).length)return 0;if(!t[0])return 1;for(var l=0,o=1;l<t.length&&o>0;l++,o--){var r=t[l].cells.reduce((function(e,t){return Math.max(e,t.rowSpan||0)}),1);r>o&&(o=r)}return l};FlexGridXlsxConverter._escapePlainText=function(e){return null==e?"":""===e?"'":e&&("'"===e[0]||e.length>1&&"="===e[0]&&"="===e[1])?"'"+e:e};FlexGridXlsxConverter._parseFlexGridRowToSheetRow=function(l,n,s,i,a,u,d,c,f,h,x,p,g){var m=l.grid,v=m.wj_sheetInfo,w=l.rows[s],_=0,C=v&&v.evaluateFormula;null==w.recordIndex?l.cellType===e.grid.CellType.ColumnHeader&&l.rows.length>1&&(_=Math.min(s,a.length-1)):_=w.recordIndex;n.cells||(n.cells=[]);n.visible=w.isVisible;n.height=w.renderHeight||l.rows.defaultSize;n.groupLevel=x;h&&(n.collapsed=w.isCollapsed);w.wordWrap&&(n.style={wordWrap:w.wordWrap});for(var y,b=w.constructor===e.grid.Row||w.constructor===e.grid._NewRowTemplate||t.softTransposed()&&m instanceof t.softTransposed().TransposedGrid&&w instanceof e.grid.Row||t.softDetail()&&w.constructor===t.softDetail().DetailRow||t.softMultiRow()&&w.constructor===t.softMultiRow()._MultiRow||t.softTransposedMultiRow()&&w instanceof t.softTransposedMultiRow()._MultiRow,T=t.softDetail()&&w.constructor===t.softDetail().DetailRow,S=0,F=Math.round(e.xlsx._xlsx._parsePixelToCharWidth(m.treeIndent)||0),getTreeIndent=function(e){return e*F};S<l.columns.length;S++){var k=void 0,R=void 0,W=void 0,G=1,A=1,B=!1,N=m._getBindingColumn(l,s,l.columns[S]),D=0;if(v&&l===m.cells){var I=s*l.columns.length+S;v.mergedRanges&&(k=this._getMergedRange(s,S,v.mergedRanges));v.styledCells&&(R=v.styledCells[I])}else if(u!==o.None){W=this._getMeasureCell(l,S,d,c);R=(k=m.getMergedRange(l,s,S,!1))?this._getCellStyle(l,W,k.bottomRow,k.rightCol,f,!!g)||{}:this._getCellStyle(l,W,s,S,f,!!g)||{}}k||(k=m.getMergedRange(l,s,S,!1));if(k){if(s===k.topRow&&S===k.leftCol){A=k.bottomRow-k.topRow+1;G=this._getColSpan(l,k,p);B=!0}}else B=!0;if(!p||p(N)){var M=a[_]?a[_][S+i]:null,E=void 0,X=void 0,H=void 0,z=void 0,O=void 0,j=void 0,L=void 0;if(b||h){H=B?l.getCellData(s,S,!0):null;z=B?l.getCellData(s,S,!1):null;X=this._isFormula(H);E=null;O=e.isDate(z);if(R&&R.format){j=R.format;/[hsmyt\:]/i.test(j)&&(O=!0);L=e.xlsx.Workbook._parseCellFormat(R.format,O)}else if(M&&M.style&&M.style.format){j=N.format;L=M.style.format}else L=null;X&&null!=C&&e.isFunction(C)&&(E=C(H));if(!L)if(O)L="m/d/yyyy";else if(e.isNumber(z)&&!N.dataMap)L=e.isInt(z)?"#,##0":"#,##0.00";else if(X){var P=H.toLowerCase();if(P.indexOf("now()")>-1){L="m/d/yyyy h:mm";O=!0}else if(P.indexOf("today()")>-1||P.indexOf("date(")>-1){L="m/d/yyyy";O=!0}else if(P.indexOf("time(")>-1){L="h:mm AM/PM";O=!0}}else L="General"}else{H=B?m.columnHeaders.getCellData(0,S,!0):null;L="General"}var V=void 0;if(e.isString(H)&&-1!==H.indexOf("<span")){V=this._parseToTextRuns(H);H=null}var U=this._parseCellStyle(R)||{};if(l===m.cells&&h&&w.hasChildren&&S===m.columns.firstVisibleIndex){var q=void 0;if(X&&null!=E)q=E;else{H?q=H:B&&(q=w.getGroupHeader());q&&(q=q.replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'"))}if(null==q&&!R)continue;!(O=e.isDate(q))&&j&&"d"===j.toLowerCase()&&e.isInt(q)&&(L="0");q=e.isString(q)?e.xlsx.Workbook._unescapeXML(q):q;S===m.columns.firstVisibleIndex&&m.treeIndent&&(D=getTreeIndent(x));y={value:q,isDate:O,formula:X?this._parseToExcelFormula(H,O):null,colSpan:G,rowSpan:A,style:this._extend(U,{format:L,font:m.childItemsPath?{}:{bold:!0},hAlign:e.xlsx.HAlign.Left,indent:D}),textRuns:V}}else{H=e.isString(H)?e.xlsx.Workbook._unescapeXML(H):H;z=e.isString(z)?e.xlsx.Workbook._unescapeXML(z):z;!O&&j&&"d"===j.toLowerCase()&&e.isInt(z)&&(L="0");var J=void 0;J=U&&U.hAlign?U.hAlign:M&&M.style&&null!=M.style.hAlign?e.asEnum(M.style.hAlign,e.xlsx.HAlign,!0):e.isDate(z)?e.xlsx.HAlign.Left:e.xlsx.HAlign.General;S!==m.columns.firstVisibleIndex||!m.treeIndent||J!==e.xlsx.HAlign.Left&&J!==e.xlsx.HAlign.General||(D=getTreeIndent(x));y={value:X?E:"General"!==L||""===H&&null==z?this._escapePlainText(z):this._escapePlainText(H),isDate:O,formula:X?this._parseToExcelFormula(H,O):null,colSpan:S<m.columns.firstVisibleIndex?1:G,rowSpan:A,style:this._extend(U,{format:L,hAlign:J,vAlign:A>1?l===m.cells||!1===m.centerHeadersVertically?e.xlsx.VAlign.Top:e.xlsx.VAlign.Center:null,indent:D}),textRuns:V}}g&&g(new r(l,new e.grid.CellRange(s,S),W,d,c,f,y));if(T){var K=l.getCellElement(s,S);if(K){var $=w.detail;K.appendChild($);e.Control.refreshAll($)}}n.cells.push(y)}}return i+S};FlexGridXlsxConverter._parseCellStyle=function(t,l){void 0===l&&(l=!1);if(null==t)return null;var o=t.fontSize;o=o?+o.substring(0,o.indexOf("px")):null;isNaN(o)&&(o=null);var r=t.whiteSpace;r=!!r&&r.indexOf("pre")>-1;var n=t.textAlign;"start"===n&&(n="rtl"===t.direction?"right":"left");"end"===n&&(n="rtl"===t.direction?"left":"right");return{font:{bold:"bold"===t.fontWeight||+t.fontWeight>=700,italic:"italic"===t.fontStyle,underline:"underline"===(t.textDecorationStyle||t.textDecoration),family:this._parseToExcelFontFamily(t.fontFamily),size:o,color:t.color},fill:{color:t.backgroundColor},borders:this._parseBorder(t,l),hAlign:e.xlsx.Workbook._parseStringToHAlign(n),wordWrap:r}};FlexGridXlsxConverter._parseBorder=function(e,t){var l={left:this._parseEgdeBorder(e,"Left"),right:this._parseEgdeBorder(e,"Right"),top:this._parseEgdeBorder(e,"Top"),bottom:this._parseEgdeBorder(e,"Bottom")};if(t){l.vertical=this._parseEgdeBorder(e,"Vertical");l.horizontal=this._parseEgdeBorder(e,"Horizontal")}return l};FlexGridXlsxConverter._parseEgdeBorder=function(t,l){var o,r=t["border"+l+"Style"],n=t["border"+l+"Width"];n&&(n=parseFloat(n));if(r&&"none"!==r&&"hidden"!==r&&0!==n){o={};switch(r=r.toLowerCase()){case"dotted":o.style=n>1?e.xlsx.BorderStyle.MediumDashDotted:e.xlsx.BorderStyle.Dotted;break;case"dashed":o.style=n>1?e.xlsx.BorderStyle.MediumDashed:e.xlsx.BorderStyle.Dashed;break;case"double":o.style=e.xlsx.BorderStyle.Double;break;default:o.style=n>2?e.xlsx.BorderStyle.Thick:n>1?e.xlsx.BorderStyle.Medium:e.xlsx.BorderStyle.Thin}o.color=t["border"+l+"Color"]}return o};FlexGridXlsxConverter._parseBorderStyle=function(t,l,o){var r="border"+l+"Style",n="border"+l+"Width";switch(t){case e.xlsx.BorderStyle.Dotted:case e.xlsx.BorderStyle.Hair:o[r]="dotted";o[n]="1px";break;case e.xlsx.BorderStyle.Dashed:case e.xlsx.BorderStyle.ThinDashDotDotted:case e.xlsx.BorderStyle.ThinDashDotted:o[r]="dashed";o[n]="1px";break;case e.xlsx.BorderStyle.MediumDashed:case e.xlsx.BorderStyle.MediumDashDotDotted:case e.xlsx.BorderStyle.MediumDashDotted:case e.xlsx.BorderStyle.SlantedMediumDashDotted:o[r]="dashed";o[n]="2px";break;case e.xlsx.BorderStyle.Double:o[r]="double";o[n]="3px";break;case e.xlsx.BorderStyle.Medium:o[r]="solid";o[n]="2px";break;case e.xlsx.BorderStyle.Thick:o[r]="solid";o[n]="3px";break;default:o[r]="solid";o[n]="1px"}};FlexGridXlsxConverter._parseToExcelFontFamily=function(e){var t;e&&(t=e.split(","))&&t.length>0&&(e=t[0].replace(/\"|\'/g,""));return e};FlexGridXlsxConverter._parseToExcelFormula=function(t,l){var o=t.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi);if(o)for(var r=0;r<o.length;r++){var n=(i=o[r]).substring(0,i.lastIndexOf(")"))+", 1)";t=t.replace(i,n)}o=null;if(o=t.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi)){var s=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;for(r=0;r<o.length;r++){var i,a=(i=o[r]).match(s);if(a&&2===a.length){var u=a[1];if(!/^d{1,4}?$/.test(u)){var d=e.xlsx.Workbook._parseCellFormat(u,l);n=i.replace(u,d);t=t.replace(i,n)}}}}return t};FlexGridXlsxConverter._parseToTextRuns=function(e){for(var t=e.split("<span "),l=[],o=0;o<t.length;o++){var r=t[o],n=void 0;n=-1!==r.indexOf("</span>")?{text:r.substring(r.indexOf(">")+1,r.indexOf("</span>")),font:this._parseToTextRunFont(r.substring(r.indexOf('style="')+7,r.indexOf(';"')))}:{text:r};l.push(n)}return l};FlexGridXlsxConverter._parseToTextRunFont=function(e){var t,l=e.split(";");if(l.length>0){for(var o=void 0,r=void 0,n=void 0,s=void 0,i=void 0,a=void 0,u=0;u<l.length;u++){var d=l[u].split(":");if(2===d.length){d[1]=d[1].trim();switch(d[0]){case"font-size":s=+d[1].substring(0,d[1].indexOf("px"));isNaN(s)&&(s=null);break;case"font-weight":o="bold"===d[1]||+d[1]>=700;break;case"font-style":r="italic"===d[1];break;case"text-decoration-style":case"text-decoration":n="underline"===d[1];break;case"font-family":i=this._parseToExcelFontFamily(d[1]);break;case"color":a=d[1]}}}t={bold:o,italic:r,underline:n,family:i,size:s,color:a}}return t};FlexGridXlsxConverter._getMeasureCell=function(e,t,l,o){var r=o[e.cellType],n=r&&r[t],s=null==n;if(n){if(this.hasCssText){n.style.cssText="";n.style.visibility="hidden"}}else{r||(o[e.cellType]=r=[]);r[t]=n=l.cloneNode()}!s&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n));return n};FlexGridXlsxConverter._getColumnSetting=function(t,l,o){var r=t;null!=t.colspan&&(r=this._getRenderColumn(l,o));return r?{autoWidth:!0,width:r.renderWidth||o.defaultSize,visible:r.visible&&0!==r.width&&!r._getFlag(e.grid.RowColFlags.ParentCollapsed),style:{format:t.format?e.xlsx.Workbook._parseCellFormat(t.format,t.dataType===e.DataType.Date):"",hAlign:e.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(r.getAlignment())),wordWrap:r.wordWrap}}:null};FlexGridXlsxConverter._getPerRowColumnsSettings=function(e,t,l){var o=this,r=[],n=[];t.forEach((function(s,i){for(var a=0,u=i>0?t[0].columns.length:0,_loop_2=function(t){if(null!=l&&t>=l)return"break";if(s.rows[t].renderSize<=0)return"continue";r[a]=r[a]||[];n[a]=n[a]||[];s.columns.forEach((function(l,i){var d=e._getBindingColumn(s,t,l),c=o._getColumnSetting(d,i,s.columns);if(c){r[a][u+i]=c;n[a][u+i]=d}}));a++},d=0;d<s.rows.length&&"break"!==_loop_2(d);d++);}));return{cols:r,bndCols:n}};FlexGridXlsxConverter._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e};FlexGridXlsxConverter._getColumnCount=function(t){for(var l=0,o=0;o<t.length;o++){var r=t[o]&&t[o].cells?t[o].cells:[];if(r&&r.length>0){var n=r.length;e.isInt(r[n-1].colSpan)&&r[n-1].colSpan>1&&(n=n+r[n-1].colSpan-1);n>l&&(l=n)}}return l};FlexGridXlsxConverter._getRowCount=function(t,l){for(var o=t.length,r=o-1,n=0;n<l;n++)e:for(;r>=0;r--){var s=t[r],i=(s&&s.cells?s.cells:[])[n];if(i&&(null!=i.value&&""!==i.value||e.isInt(i.rowSpan)&&i.rowSpan>1)){e.isInt(i.rowSpan)&&i.rowSpan>1&&r+i.rowSpan>o&&(o=r+i.rowSpan);break e}}return o};FlexGridXlsxConverter._numAlpha=function(e){var t=Math.floor(e/26)-1;return(t>-1?this._numAlpha(t):"")+String.fromCharCode(65+e%26)};FlexGridXlsxConverter._getItemType=function(t){return null==t||null==t.value||isNaN(t.value)?null:e.getType(t.value)};FlexGridXlsxConverter._setColumn=function(t,l,o){var r=t[l];if(r){var n=this._getItemType(o);r.dataType!==n&&r.dataType===e.DataType.Boolean&&n!==e.DataType.Boolean&&(r.dataType=n);if(o&&null!=o.value&&(!e.isString(o.value)||!e.isNullOrWhiteSpace(o.value))){var s=e.xlsx.Workbook._parseExcelFormat(o);s&&r.format!==s&&"General"!==s&&(r.format=s)}var i=void 0;if(o&&o.style){o.style.hAlign&&(i=e.xlsx.Workbook._parseHAlignToString(e.asEnum(o.style.hAlign,e.xlsx.HAlign)));null==r.wordWrap?r.wordWrap=!!o.style.wordWrap:r.wordWrap=r.wordWrap&&!!o.style.wordWrap}i||n!==e.DataType.Number||(i="right");r.hAlign=i}else t[l]={dataType:this._getItemType(o),format:e.xlsx.Workbook._parseExcelFormat(o),hAlign:"",wordWrap:null}};FlexGridXlsxConverter._getItemValue=function(t){if(null==t||null==t.value)return null;var l=t.value;e.isString(l)&&"'"===l[0]&&(l=l.substr(1));return e.isNumber(l)&&isNaN(l)?"":l instanceof Date&&isNaN(l.getTime())?"":l};FlexGridXlsxConverter._getCellStyle=function(e,t,l,o,r,n){var s,i=e.grid;try{var a=!(r&&!i.formatItem.hasHandlers&&!i.itemFormatter&&!n);i.cellFactory.updateCell(e,l,o,t,null,a);t.className=t.className.replace("wj-state-selected","");t.className=t.className.replace("wj-state-multi-selected","")}catch(e){return null}if(r){var u=e.hostElement,d=t,c=d.style.cssText.split(/;\s+/).filter((function(e){var t=e.substring(0,e.indexOf(":"));return/^(color|background|border|font|text|whitespace)/i.test(t)})).join(";");do{c=d.className+c}while(d!==u&&(d=d.parentElement));if(!(s=r.getValue(c))){s=window.getComputedStyle(t);r.add(c,s)}}else s=window.getComputedStyle(t);return s};FlexGridXlsxConverter._parseTextRunsToHTML=function(e){for(var t="",l=0;l<e.length;l++){var o=e[l],r=o.font;t+=r?'<span style="'+(r.bold?"font-weight: bold;":"")+(r.italic?"font-style: italic;":"")+(r.underline?"text-decoration: underline;":"")+(r.family?"font-family: "+r.family+";":"")+(null!=r.size?"font-size: "+r.size+"px;":"")+(r.color?"color: "+r.color+";":"")+'">'+o.text+"</span>":o.text}return t};FlexGridXlsxConverter._extend=function(t,l){for(var o in l){var r=l[o];e.isObject(r)&&t[o]?e.copy(t[o],r):t[o]=r}return t};FlexGridXlsxConverter._checkParentCollapsed=function(e,t){var l=!1;Object.keys(e).forEach((function(o){!0===e[o]&&!1===l&&!isNaN(t)&&+o<t&&(l=!0)}));return l};FlexGridXlsxConverter._getColSpan=function(e,t,l){for(var o=0,r=t.leftCol;r<=t.rightCol;r++)l&&!l(e.columns[r])||o++;return o};FlexGridXlsxConverter._getRenderColumn=function(e,t){return e>=t.length?null:t[e]};FlexGridXlsxConverter._getMergedRange=function(e,t,l){for(var o=0;o<l.length;o++){var r=l[o];if(e>=r.topRow&&e<=r.bottomRow&&t>=r.leftCol&&t<=r.rightCol)return r}return null};FlexGridXlsxConverter._isFormula=function(e){return e&&"string"==typeof e&&e.length>1&&"="===e[0]&&"="!==e[1]};return FlexGridXlsxConverter}();t.FlexGridXlsxConverter=l;var o,r=function(e){__extends(XlsxFormatItemEventArgs,e);function XlsxFormatItemEventArgs(t,l,o,r,n,s,i){var a=e.call(this,t,l)||this;a._cell=o;a._patternCell=r;a._xlsxCell=i;a._cellsCache=n;a._styleCache=s;return a}Object.defineProperty(XlsxFormatItemEventArgs.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(XlsxFormatItemEventArgs.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0});XlsxFormatItemEventArgs.prototype.getFormattedCell=function(){if(!this._cell){this._cell=l._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache);l._getCellStyle(this.panel,this._cell,this.row,this.col,this._styleCache,!0)}return this._cell};return XlsxFormatItemEventArgs}(e.grid.CellRangeEventArgs);t.XlsxFormatItemEventArgs=r;!function(e){e[e.None=0]="None";e[e.Regular=1]="Regular";e[e.Cache=2]="Cache"}(o||(o={}));var n=function(){function _StyleCache(e){this._cache={};this._size=0;this._max=e}_StyleCache.prototype.add=function(e,t){this._size>=this._max&&this.clear();this._cache[e]=this._cloneStyle(t);this._size++};_StyleCache.prototype.clear=function(){this._cache={};this._size=0};_StyleCache.prototype.getValue=function(e){return this._cache[e]||null};_StyleCache.prototype.hasKey=function(e){return!!this._cache[e]};_StyleCache.prototype._cloneStyle=function(e){if(!e)return null;for(var t={},toCamel=function(e){return e.replace(/\-([a-z])/g,(function(e,t,l){return l>0?t.toUpperCase():t}))},l=0,o=e.length;l<o;l++){var r=e[l];t[toCamel(r)]=e.getPropertyValue(r)}return t};return _StyleCache}();t._StyleCache=n;function _blobToBuffer(e,t){if(e&&t)if(e.arrayBuffer)e.arrayBuffer().then((function(e){return t(e)}));else{var l=new FileReader;l.onload=function(){t(l.result);l=null};l.readAsArrayBuffer(e)}}t._blobToBuffer=_blobToBuffer})((t=e.grid||(e.grid={})).xlsx||(t.xlsx={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.xlsx||(t.xlsx={}),e._registerModule("wijmo.grid.xlsx",e.grid.xlsx)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));