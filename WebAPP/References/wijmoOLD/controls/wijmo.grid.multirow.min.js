/*!
    *
    * Wijmo Library 5.20213.824
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){extendStatics(t,e);function __(){this.constructor=t}t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}();!function(t){var e;(function(e){"use strict";var o=function(t){__extends(_MultiRow,t);function _MultiRow(e,o,r){var n=t.call(this,e)||this;n._idxData=o;n._idxRecord=r;return n}Object.defineProperty(_MultiRow.prototype,"recordIndex",{get:function(){return this._idxRecord},enumerable:!0,configurable:!0});return _MultiRow}(t.grid.Row);e._MultiRow=o;var r=function(e){__extends(_MultiGroupRow,e);function _MultiGroupRow(t,o){var r=e.call(this,t)||this;r._idxRecord=o;return r}Object.defineProperty(_MultiGroupRow.prototype,"recordIndex",{get:function(){return this._idxRecord},enumerable:!0,configurable:!0});Object.defineProperty(_MultiGroupRow.prototype,"hasChildren",{get:function(){return!0},enumerable:!0,configurable:!0});_MultiGroupRow.prototype.getCellRange=function(){var t=this._getLastRowInHeader();return t!=this?t.getCellRange():e.prototype.getCellRange.call(this)};Object.defineProperty(_MultiGroupRow.prototype,"isCollapsed",{get:function(){return this._getLastRowInHeader()._getFlag(t.grid.RowColFlags.Collapsed)},set:function(e){var o=this._getLastRowInHeader();e!=o.isCollapsed&&null!=o._list&&o._setCollapsed(t.asBoolean(e))},enumerable:!0,configurable:!0});_MultiGroupRow.prototype._setCollapsed=function(e){var o=this,r=this.grid,n=r.rows,i=this.getCellRange(),l=new t.grid.CellRangeEventArgs(r.cells,new t.grid.CellRange(this.index,-1));if(r.onGroupCollapsedChanging(l)){r.deferUpdate((function(){n.deferUpdate((function(){o._setFlag(t.grid.RowColFlags.Collapsed,e,!0);for(var r=i.topRow+1;r<=i.bottomRow&&r>-1&&r<n.length;r++){n[r]._setFlag(t.grid.RowColFlags.ParentCollapsed,e,!0);var l=n[r];if(l instanceof _MultiGroupRow){var a=l._getLastRowInHeader();for(r+=1;r<=a.index;r++)(l=n[r])._setFlag(t.grid.RowColFlags.ParentCollapsed,e,!0);r--}l instanceof t.grid.GroupRow&&l.isCollapsed&&(r=l.getCellRange().bottomRow)}}))}));r.onGroupCollapsedChanged(l)}};_MultiGroupRow.prototype._getLastRowInHeader=function(){var e=this.grid,o=this;if(e&&e.multiRowGroupHeaders)for(var r=e.rows,n=this.dataItem,i=this.index+1;i<r.length&&r[i].dataItem==n;i++)o=r[i];t.assert(o instanceof _MultiGroupRow,"last row in header should be a _MultiRowGroup");return o};return _MultiGroupRow}(t.grid.GroupRow);e._MultiGroupRow=r})((e=t.grid||(t.grid={})).multirow||(e.multirow={}))}(wijmo||(wijmo={}));!function(t){!function(e){!function(e){"use strict";var o=function(e){__extends(MultiRowCellCollection,e);function MultiRowCellCollection(){return null!==e&&e.apply(this,arguments)||this}MultiRowCellCollection.prototype._setLayout=function(t){this._layout=t;this.forEach((function(e){return e._setLayout(t)}))};MultiRowCellCollection.prototype.onCollectionChanged=function(o){void 0===o&&(o=t.collections.NotifyCollectionChangedEventArgs.reset);var r=this._layout;r&&r._onLayoutChanged();e.prototype.onCollectionChanged.call(this,o)};return MultiRowCellCollection}(t.collections.ObservableArray);e.MultiRowCellCollection=o}(e.multirow||(e.multirow={}))}(t.grid||(t.grid={}))}(wijmo||(wijmo={}));!function(t){var e;(function(e){"use strict";var o=function(){function _MultiRowLayout(t,e,o){this._initialized=!1;this._disposed=!1;this._rowsPerItem=1;this._groupsByColumn={};this._grid=t;this._changeCallback=o;this._bindingGroups=this._parseCellGroups(e);this._initialized=!0}_MultiRowLayout.prototype._dispose=function(){if(!this._disposed){this._disposed=!0;var t=this._bindingGroups;t.forEach((function(t){t.cells._setLayout(null)}));t._setLayout(null);this._bindingGroups=null}};_MultiRowLayout.prototype._onLayoutChanged=function(){this._initialized&&!this._disposed&&this._changeCallback&&this._changeCallback()};_MultiRowLayout.prototype._parseCellGroups=function(o){var r=this,n=this._grid,i=null,l=1;if(o){if(o instanceof e.MultiRowCellCollection){o.forEach((function(o){t.assert(o instanceof e.MultiRowCellGroup,"groups contain items of invalid type")}));i=o}else{i=new e.MultiRowCellCollection;for(var a=0;a<o.length;a++){var s=null;s=o[a]instanceof e.MultiRowCellGroup?o[a]:new e.MultiRowCellGroup(o[a]);i.push(s)}}i.forEach((function(t){t.openGroup()}));a=0;for(var u=0;a<i.length;a++){(s=i[a])._colstart=u;u+=s._colspanEff;l=Math.max(l,s._rowspanEff)}i.forEach((function(t){t.closeGroup(n,l)}));this._rowsPerItem=l}else i=new e.MultiRowCellCollection;this._multiRowGroupHeaderRange=this._getMultiRowGroupHeaderRange(i);i.forEach((function(t){t.cells._setLayout(r)}));i._setLayout(this);return i};_MultiRowLayout.prototype._getMultiRowGroupHeaderRange=function(e){for(var o=this._rowsPerItem,r=new t.grid.CellRange(0,0,o-1,0),n=0;n<e.length;n++){var i=e[n];if(i._hasAggregates){0===n&&this._expandMultiRowGroupHeaderToAggregate(r,i);return r}r.col2=i._colstart+i._colspanEff-1}return r};_MultiRowLayout.prototype._expandMultiRowGroupHeaderToAggregate=function(t,e){var o=this._rowsPerItem,r=e._colspanEff,n=e.cells.filter((function(t){return t.col>0&&0!=t.aggregate})).map((function(t){return t.col})).reduce((function(t,e){return e<t?e:t}),r);t.col2=Math.max(e._colstart+n-1,t.col2);for(var i=n;i<r;i++){for(var l=!0,a=0;a<o;a++){var s=e._getCellRange(a,i);l=l&&s.col===i}if(l){t.col2=Math.max(e._colstart+i-1,t.col2);return}}};_MultiRowLayout.prototype._getSingleRowGroupHeaderRange=function(e,o,r){var n=this._bindingGroups;if(0===n.length)return null;var i=this._getGroupByColumn(r);t.assert(null!=i,"Failed to get the group!");var l=i._getCellRange(0,r-i._colstart),a=new t.grid.CellRange(o,i._colstart+l.col,o,i._colstart+l.col2);if(0!=i.getBindingColumn(e,o,r).aggregate)return a;for(var s=n[0]._colstart,u=r-1;u>=s;u--){var c=this._getGroupByColumn(u);t.assert(null!=c,"Failed to get the group!");if(0!=c.getBindingColumn(e,o,u).aggregate)break;l=c._getCellRange(0,u-c._colstart);a.col=c._colstart+l.col}var d=n[n.length-1],p=d._colstart+d._colspanEff;for(u=r+1;u<p;u++){var f=this._getGroupByColumn(u);t.assert(null!=f,"Failed to get the group!");if(0!=f.getBindingColumn(e,o,u).aggregate)break;l=f._getCellRange(0,u-f._colstart);a.col2=f._colstart+l.col2}return a};_MultiRowLayout.prototype._getGroupHeaderMergedRange=function(o,r,n,i){if(i){var l=this._multiRowGroupHeaderRange;if(l.containsColumn(n)){var a=this._rowsPerItem,s=Math.floor(r/a)*a;return new t.grid.CellRange(s+l.row,l.col,s+l.row2,l.col2)}var u=this._getGroupByColumn(n);t.assert(u instanceof e.MultiRowCellGroup,"Failed to get the group!");return u.getMergedRange(o,r,n)}return this._getSingleRowGroupHeaderRange(o,r,n)};_MultiRowLayout.prototype._getGroupByColumn=function(t){var e=this._groupsByColumn[t];if(!e)for(var o=this._bindingGroups,r=0;r<o.length;r++)if(t>=(e=o[r])._colstart&&t<=e._colstart+e._colspanEff-1){this._groupsByColumn[t]=e;break}return e};_MultiRowLayout.prototype._updateCellTypes=function(e){this._bindingGroups.forEach((function(o){o._cols.forEach((function(o){null==o.dataType&&o._binding&&(o.dataType=t.getType(o._binding.getValue(e)));if(!o.isReadOnly){var r=t.isIE()?null:Object.getOwnPropertyDescriptor(e,o.binding);o.isReadOnly=r&&!r.writable&&!r.set}}))}))};return _MultiRowLayout}();e._MultiRowLayout=o})((e=t.grid||(t.grid={})).multirow||(e.multirow={}))}(wijmo||(wijmo={}));!function(t){!function(e){!function(e){"use strict";var o=function(e){__extends(MultiRowCell,e);function MultiRowCell(o){var r=e.call(this)||this;r._row=r._col=0;r._rowspan=r._colspan=1;t.copy(r,o);return r}Object.defineProperty(MultiRowCell.prototype,"row",{get:function(){return this._row},set:function(e){var o=t.asInt(e,!1,!0);if(this._row!=o){this._row=o;this._onLayoutPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiRowCell.prototype,"col",{get:function(){return this._col},set:function(e){var o=t.asInt(e,!1,!0);if(this._col!=o){this._col=o;this._onLayoutPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiRowCell.prototype,"colspan",{get:function(){return this._colspan},set:function(e){var o=t.asInt(e,!1,!0);t.assert(o>0,"colspan must be >= 1");if(this._colspan!=o){this._colspan=o;this._onLayoutPropertyChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiRowCell.prototype,"rowspan",{get:function(){return this._rowspan},set:function(e){var o=t.asInt(e,!1,!0);t.assert(o>0,"rowspan must be >= 1");if(this._rowspan!=o){this._rowspan=o;this._onLayoutPropertyChanged()}},enumerable:!0,configurable:!0});MultiRowCell.prototype._setLayout=function(t){this._layout=t};MultiRowCell.prototype._onLayoutPropertyChanged=function(){var t=this._layout;t&&t._onLayoutChanged()};return MultiRowCell}(t.grid.Column);e.MultiRowCell=o}(e.multirow||(e.multirow={}))}(t.grid||(t.grid={}))}(wijmo||(wijmo={}));!function(t){!function(e){!function(e){"use strict";var o=function(o){__extends(MultiRowCellGroup,o);function MultiRowCellGroup(r){var n=o.call(this)||this;n._isRowHeader=!1;n._colstart=0;n._cells=new e.MultiRowCellCollection;t.copy(n,r);return n}MultiRowCellGroup.prototype._copy=function(e,o){if("cells"==e){t.isArray(o)&&(this._cellsDef=o);return!0}return!1};Object.defineProperty(MultiRowCellGroup.prototype,"cells",{get:function(){return this._cells},enumerable:!0,configurable:!0});Object.defineProperty(MultiRowCellGroup.prototype,"isRowHeader",{get:function(){return this._isRowHeader},set:function(e){var o=t.asBoolean(e);if(this._isRowHeader!=o){this._isRowHeader=o;this._onLayoutPropertyChanged()}},enumerable:!0,configurable:!0});MultiRowCellGroup.prototype.openGroup=function(){if(!this._isParsed){this._cells=this._parseCells(this._cellsDef);this._isParsed=!0}this._calculate()};MultiRowCellGroup.prototype.closeGroup=function(e,o){var r=this;if(o>this._rowspanEff){this._cells.forEach((function(t){t.row==r._rowspanEff-1&&(t._rowspanEff=o-t.row)}));this._rowspanEff=o}this._cells.forEach((function(t){for(;t.col+t._colspanEff<r._colspanEff&&!r._slotTaken(t.row,t.col+t._colspanEff);)t._colspanEff++}));this._cells.forEach((function(t){for(;t.row+t._rowspanEff<r._rowspanEff&&!r._slotTaken(t.row+t._rowspanEff,t.col);)t._rowspanEff++}));if(this._cells.length>0)for(var n=0;n<this._rowspanEff;n++)for(var i=0;i<this._colspanEff;i++)t.assert(this._slotTaken(n,i),"Invalid layout (empty cells).");this._cols=new t.grid.ColumnCollection(e,e.columns.defaultSize);this._rng=new Array(o*this._colspanEff);this._cells.forEach((function(e){for(var o=0;o<e._rowspanEff;o++)for(var n=0;n<e._colspanEff;n++){var i=(e.row+o)*r._colspanEff+e.col+n;r._cols.setAt(i,e);var l=new t.grid.CellRange(0-o,0-n,0-o+e._rowspanEff-1,0-n+e._colspanEff-1);l.isSingleCell||(r._rng[i]=l)}}));var l=this._colstart;this._rng[-1]=new t.grid.CellRange(0,l,0,l+this._colspanEff-1);this._hasAggregates=!1;for(var a=0;a<this._cells.length&&!this._hasAggregates;a++)this._hasAggregates=0!=this._cells[a].aggregate};MultiRowCellGroup.prototype.getColumnWidth=function(t){for(var e=0;e<this._cells.length;e++){var o=this._cells[e];if(o.col==t&&1==o._colspanEff)return o.width}return null};MultiRowCellGroup.prototype.getMergedRange=function(e,o,r){if(o<0)return this._rng[-1];var n=e.rows[o],i=null!=n.recordIndex?n.recordIndex:o%this._rowspanEff,l=r-this._colstart,a=this._rng[i*this._colspanEff+l];e.cellType==t.grid.CellType.ColumnHeader&&o++;return a?new t.grid.CellRange(o+a.row,r+a.col,o+a.row2,r+a.col2):null};MultiRowCellGroup.prototype.getBindingColumn=function(t,e,o){if(e<0)return this;var r=t.rows[e],n=r&&null!=r.recordIndex?r.recordIndex:e%this._rowspanEff,i=o-this._colstart;return this._cols[n*this._colspanEff+i]};MultiRowCellGroup.prototype.getColumn=function(t){return this._cols.getColumn(t)};MultiRowCellGroup.prototype._getCellRange=function(e,o){var r=this._rng[e*this._colspanEff+o];return r?new t.grid.CellRange(e+r.row,o+r.col,e+r.row2,o+r.col2):new t.grid.CellRange(e,o)};MultiRowCellGroup.prototype._parseCells=function(o){var r=this._cells;if(o){if(o instanceof e.MultiRowCellCollection){o.forEach((function(o){t.assert(o instanceof e.MultiRowCell,"cells contain items of invalid type")}));r=o}else o.forEach((function(t){var o=null;o=t instanceof e.MultiRowCell?t:new e.MultiRowCell(t);r.push(o)}));r.forEach((function(e){e.binding&&!e.header&&(e.header=t.toHeaderCase(e.binding))}))}return r};MultiRowCellGroup.prototype._clearCalculations=function(){this._colstart=0;this._cols=null;this._hasAggregates=!1;this._rng=null;this.row=0;this.col=0;this._colspanEff=0;this._rowspanEff=0;this._cells.forEach((function(t){t.row=0;t.col=0;t._colspanEff=0;t._rowspanEff=0}))};MultiRowCellGroup.prototype._calculate=function(){var t=this;this._clearCalculations();this._colspanEff=this.colspan;this._rowspanEff=this.rowspan;this._cells.forEach((function(e){t._colspanEff=Math.max(t._colspanEff,e.colspan);e._colspanEff=e.colspan;e._rowspanEff=e.rowspan}));var e=0,o=0;this._cells.forEach((function(r,n){for(;!t._cellFits(r,n,e,o);)0==(o=(o+1)%t._colspanEff)&&e++;r.row=e;r.col=o}));var r=1,n=1;this._cells.forEach((function(t){r=Math.max(r,t.row+t._rowspanEff);n=Math.max(n,t.col+t._colspanEff)}));this._rowspanEff=r;this._colspanEff=n};MultiRowCellGroup.prototype._cellFits=function(t,e,o,r){if(r>0&&r+t._colspanEff>this._colspanEff)return!1;for(var n=0;n<t._colspanEff;n++)if(this._slotTaken(o,r+n,e))return!1;this._colspanEff=Math.max(this._colspanEff,r+t._colspanEff-1);return!0};MultiRowCellGroup.prototype._slotTaken=function(t,e,o){void 0===o&&(o=this._cells.length);for(var r=0;r<o;r++){var n=this._cells[r];if(t>=n.row&&t<=n.row+n._rowspanEff-1&&e>=n.col&&e<=n.col+n._colspanEff-1)return!0}return!1};return MultiRowCellGroup}(e.MultiRowCell);e.MultiRowCellGroup=o}(e.multirow||(e.multirow={}))}(t.grid||(t.grid={}))}(wijmo||(wijmo={}));!function(t){!function(e){!function(e){"use strict";var o=function(o){__extends(MultiRow,o);function MultiRow(r,n){var i=o.call(this,r)||this;i._hdrLayoutDef=null;i._centerVert=!0;i._collapsedHeaders=!1;i._multiRowGroupHeaders=!1;i._rowHdrCnt=0;i.collapsedHeadersChanging=new t.Event;i.collapsedHeadersChanged=new t.Event;i._layoutDef=new e.MultiRowCellCollection;i._layout=new e._MultiRowLayout(i,i._layoutDef,(function(){return i._onLayoutChanged()}));t.addClass(i.hostElement,"wj-multirow");var l=i.columnHeaders.hostElement.parentElement,a=t.createElement('<div class="wj-hdr-collapse"><span></span></div>');a.style.display="none";l.appendChild(a);i._btnCollapse=a;i._updateButtonGlyph();i.addEventListener(a,"mousedown",(function(t){switch(i.collapsedHeaders){case null:case!1:i._collapsedHeadersWasNull=null==i.collapsedHeaders;i.collapsedHeaders=!0;break;case!0:i.collapsedHeaders=!!i._collapsedHeadersWasNull&&null}t.preventDefault();i.focus()}),!0);var s=i.hostElement;i.addEventListener(s,"mousedown",(function(t){if(!i._mouseHdl._szRowCol){var e=i._layout?i._layout._bindingGroups:null,o=e&&e.length?e[0]:null;if(o&&o.isRowHeader){var r=i.hitTest(t);if(r.panel==i.columnHeaders&&r.col<i.frozenColumns){t.preventDefault();i.selectAll()}}}}),!0);["dragover","dragleave","dragdrop"].forEach((function(t){i.removeEventListener(s,t)}));i._addHdl=new e._MultiRowAddNewHandler(i);i.formatItem.addHandler(i._formatItem,i);i.autoGenerateColumns=!1;i.allowDragging=t.grid.AllowDragging.None;i.mergeManager=new e._MergeManager;i.initialize(n);return i}MultiRow.prototype._getProductInfo=function(){return"H87K,MultiRow"};Object.defineProperty(MultiRow.prototype,"layoutDefinition",{get:function(){return this._layoutDef},set:function(o){var r=this;this.finishEditing()||this.finishEditing(!0);this._layoutDef=t.asArray(o);if(this._layout){this._layout._dispose();this._layout=null}this._layout=new e._MultiRowLayout(this,o,(function(){return r._onLayoutChanged()}));this._rowHdrCnt=0;if(this._layout)for(var n=this._layout._bindingGroups,i=0;i<n.length;i++){var l=n[i];if(!l.isRowHeader)break;this._rowHdrCnt=l._colstart+l._colspanEff;l.cells.forEach((function(t){t.isReadOnly=!0;!t.header||t.binding||t.cellTemplate||(t.cellTemplate=t.header);t.cssClass?t.cssClass.indexOf("wj-header")<0&&(t.cssClass+=" wj-header"):t.cssClass="wj-header"}))}this._rowHdrCnt&&(this.frozenColumns=this._rowHdrCnt);this._bindGrid(!0);this._rowHdrCnt&&this.selectionMode&&this.select(this.selection.row,this._rowHdrCnt)},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"headerLayoutDefinition",{get:function(){return this._hdrLayoutDef},set:function(o){var r=this;this._hdrLayoutDef=t.asArray(o);if(this._hdrLayout){this._hdrLayout._dispose();this._hdrLayout=null}var n=null;o&&(n=new e._MultiRowLayout(this,o,(function(){return r._onHeaderLayoutChanged()})));this._hdrLayout=n;this._bindGrid(!0)},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"rowsPerItem",{get:function(){return this._layout._rowsPerItem},enumerable:!0,configurable:!0});MultiRow.prototype.getBindingColumn=function(t,e,o){return this._getBindingColumn(t,e,t.columns[o])};MultiRow.prototype.getColumn=function(e,r){if(t.isString(e)){for(var n=r&&this._hdrLayout,i=(n?this._hdrLayout:this._layout)._bindingGroups,l=null,a=0;a<i.length&&!l;a++)l=i[a].getColumn(e);return!l&&n?this.getColumn(e,!1):l}return o.prototype.getColumn.call(this,e)};Object.defineProperty(MultiRow.prototype,"centerHeadersVertically",{get:function(){return this._centerVert},set:function(e){if(e!=this._centerVert){this._centerVert=t.asBoolean(e);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"collapsedHeaders",{get:function(){return this._collapsedHeaders},set:function(e){if(e!=this._collapsedHeaders){var o=new t.CancelEventArgs;if(this.onCollapsedHeadersChanging(o)){this._collapsedHeaders=t.asBoolean(e,!0);this._updateCollapsedHeaders();this._updateButtonGlyph();this.onCollapsedHeadersChanged(o)}}},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"showHeaderCollapseButton",{get:function(){return""==this._btnCollapse.style.display},set:function(e){e!=this.showHeaderCollapseButton&&(this._btnCollapse.style.display=t.asBoolean(e)?"":"none")},enumerable:!0,configurable:!0});Object.defineProperty(MultiRow.prototype,"multiRowGroupHeaders",{get:function(){return this._multiRowGroupHeaders},set:function(e){if(e!=this._multiRowGroupHeaders){this._multiRowGroupHeaders=t.asBoolean(e);this._bindGrid(!0)}},enumerable:!0,configurable:!0});MultiRow.prototype.onCollapsedHeadersChanging=function(t){this.collapsedHeadersChanging.raise(this,t);return!t.cancel};MultiRow.prototype.onCollapsedHeadersChanged=function(t){this.collapsedHeadersChanged.raise(this,t)};Object.defineProperty(MultiRow.prototype,"allowPinning",{get:function(){return!1},set:function(e){t.assert(!e,"MultiRow does not support pinning.")},enumerable:!0,configurable:!0});MultiRow.prototype.onSelectionChanging=function(r){var n=r._rng;if(n&&n.isValid&&this.selectionMode){var i=this._mouseHdl._htDown,l=this.rows,a=this.columns,s=this._rowHdrCnt;if(s){n.col=Math.max(n.col,s);n.col2=Math.max(n.col2,s)}if(i&&(i.panel==this.rowHeaders||i.panel==this.cells&&i.col<s)){var u=l[n.topRow],c=l[n.bottomRow];if(u&&null!=u.recordIndex){var d=u.index-u.recordIndex,p=c instanceof e._MultiGroupRow&&!this._multiRowGroupHeaders?1:this.rowsPerItem,f=c.index-c.recordIndex+p-1,h=a.length-1,_=n.row!=n.topRow?new t.grid.CellRange(f,0,d,h):new t.grid.CellRange(d,0,f,h);n.row=_.row;n.row2=_.row2;n.col2=h;switch(this.selectionMode){case t.grid.SelectionMode.Cell:n.row2=_.row;n.col2=_.col;break;case t.grid.SelectionMode.Row:n.row2=_.row}}}}return o.prototype.onSelectionChanging.call(this,r)};MultiRow.prototype._getDeleteColumnIndex=function(){return this._rowHdrCnt};MultiRow.prototype._getQuickAutoSize=function(){return t.isBoolean(this.quickAutoSize)?this.quickAutoSize:this.formatItem.handlerCount<=1&&null==this.itemFormatter};MultiRow.prototype._addBoundRow=function(t,o){for(var r=t[o],n=0;n<this.rowsPerItem;n++)this.rows.push(new e._MultiRow(r,o,n))};MultiRow.prototype._addNode=function(t,e,o){this._addBoundRow(t,e)};MultiRow.prototype._addGroupRow=function(t){for(var o=this._multiRowGroupHeaders?this.rowsPerItem:1,r=0;r<o;r++)this.rows.push(new e._MultiGroupRow(t,r))};MultiRow.prototype._bindColumns=function(){for(var e=this,o=this.columnHeaders.rows,r=this._layout,n=this._hdrLayout,i=(n?n._rowsPerItem:this.rowsPerItem)+1;o.length>i;)o.removeAt(o.length-1);for(;o.length<i;)o.push(new t.grid.Row);this._updateCollapsedHeaders();this.columns.clear();if(r){var l="width,minWidth,maxWidth,binding,header,format,dataMap,name,aggregate,cellTemplate".split(",");r._bindingGroups.forEach((function(o){for(var _loop_1=function(r){if(0===o.cells.length)return"continue";for(var n=new t.grid.Column,_loop_2=function(t){var e=o.cells[t];e.col==r&&l.forEach((function(t){null!=e[t]&&e[t]!=n[t]&&(n[t]=e[t])}))},i=0;i<o.cells.length;i++)_loop_2(i);e.columns.push(n)},r=0;r<o._colspanEff;r++)_loop_1(r)}))}};MultiRow.prototype._updateCollapsedHeaders=function(){var t=this.columnHeaders.rows,e=this.collapsedHeaders;t[0].visible=0!=e;for(var o=1;o<t.length;o++)t[o].visible=1!=e};MultiRow.prototype._updateColumnTypes=function(){o.prototype._updateColumnTypes.call(this);var e=this.collectionView;if(t.hasItems(e)){var r=e.items[0];this._layout&&this._layout._updateCellTypes(r);this._hdrLayout&&this._hdrLayout._updateCellTypes(r)}};MultiRow.prototype._getBindingColumn=function(e,o,r){if(r&&(e==this.cells||e==this.columnHeaders)){var n=e.cellType==t.grid.CellType.ColumnHeader;n&&o--;r=this._getGroupByColumn(r.index,n).getBindingColumn(e,o,r.index)}return r};MultiRow.prototype._getBindingColumns=function(){var t=[];this._layout._bindingGroups.forEach((function(e){e._cols.forEach((function(e){t.indexOf(e)<0&&t.push(e)}))}));return t};MultiRow.prototype._getRowsPerItem=function(){return this.rowsPerItem};MultiRow.prototype._cvCollectionChanged=function(o,r){if(this.autoGenerateColumns&&0==this.columns.length)this._bindGrid(!0);else{var n=t.collections.NotifyCollectionChangedAction;switch(r.action){case n.Change:this.invalidate();break;case n.Add:if(r.index==this.collectionView.items.length-1){for(var i=this.rows.length;i>0&&this.rows[i-1]instanceof t.grid._NewRowTemplate;)i--;for(var l=0;l<this.rowsPerItem;l++)this.rows.insert(i+l,new e._MultiRow(r.item,r.index,l));return}t.assert(!1,"added item should be the last one.");break;default:this._bindGrid(!1)}}};MultiRow.prototype._getGroupByColumn=function(o,r){var n=null;r&&this._hdrLayout&&!this.collapsedHeaders&&(n=this._hdrLayout._getGroupByColumn(o));n||(n=this._layout._getGroupByColumn(o));t.assert(n instanceof e.MultiRowCellGroup,"Failed to get the group!");return n};MultiRow.prototype._onLayoutChanged=function(){this.layoutDefinition=this._layoutDef};MultiRow.prototype._onHeaderLayoutChanged=function(){this.headerLayoutDefinition=this._hdrLayoutDef};MultiRow.prototype._formatItem=function(o,r){var n=this.rowsPerItem,i=r.panel,l=i.cellType,a=i.rows[r.range.row],s=i.rows[r.range.row2],u=r.cell,c=t.grid.CellType;l==c.ColumnHeader&&t.toggleClass(u,"wj-group-header",0==r.range.row);if(l==c.Cell||l==c.ColumnHeader){var d=this._getGroupByColumn(r.col,l==c.ColumnHeader);t.toggleClass(u,"wj-group-start",d._colstart==r.range.col);t.toggleClass(u,"wj-group-end",d._colstart+d._colspanEff-1==r.range.col2)}if(n>1&&(l==c.Cell||l==c.RowHeader)){var p=a instanceof e._MultiRow||a instanceof e._MultiRowNewRowTemplate,f=s instanceof e._MultiRow||s instanceof e._MultiRowNewRowTemplate;t.toggleClass(u,"wj-record-start",!!p&&0==a.recordIndex);t.toggleClass(u,"wj-record-end",!!f&&s.recordIndex==n-1)}var h=this.alternatingRowStep;if(h){var _=!1;if(a instanceof e._MultiRow){_=a.dataIndex%(h+1)==0;1==h&&(_=!_)}t.toggleClass(u,"wj-alt",_)}if(this._centerVert&&!u.getAttribute("wj-state-measuring")){var w=r.range.rowSpan>1;if(w&&r.updateContent)if(0==u.childElementCount)u.innerHTML="<div>"+u.innerHTML+"</div>";else{var g=document.createElement("div"),y=document.createRange();y.selectNodeContents(u);y.surroundContents(g)}t.toggleClass(u,"wj-center-vert",w)}};MultiRow.prototype._updateButtonGlyph=function(){var t=this._btnCollapse.querySelector("span");t instanceof HTMLElement&&(t.className=this.collapsedHeaders?"wj-glyph-left":"wj-glyph-down-left")};MultiRow.prototype._getError=function(e,r,n,i){if(t.isFunction(this.itemValidator)&&e==this.rowHeaders)for(var l=0;l<this.rowsPerItem;l++)for(n=0;n<this.columns.length;n++){var a=this.itemValidator(r+l,n,i);if(a)return a}return o.prototype._getError.call(this,e,r,n,i)};return MultiRow}(t.grid.FlexGrid);e.MultiRow=o}(e.multirow||(e.multirow={}))}(t.grid||(t.grid={}))}(wijmo||(wijmo={}));!function(t){var e;(function(e){"use strict";var o=function(o){__extends(_MergeManager,o);function _MergeManager(){return null!==o&&o.apply(this,arguments)||this}_MergeManager.prototype.getMergedRange=function(o,r,n,i){void 0===i&&(i=!0);var l=o.grid;if(r<0||r>=o.rows.length||n<0||n>=o.columns.length)return null;switch(o.cellType){case t.grid.CellType.Cell:case t.grid.CellType.RowHeader:if(o.rows[r]instanceof t.grid.GroupRow&&!l.multiRowGroupHeaders)return this._getGroupRowMergedRange(o,r,n,i,!1)}switch(o.cellType){case t.grid.CellType.Cell:if(o.rows[r]instanceof t.grid.GroupRow)return this._getGroupRowMergedRange(o,r,n,i,l.multiRowGroupHeaders);case t.grid.CellType.ColumnHeader:var a=o.cellType==t.grid.CellType.ColumnHeader,s=l._getGroupByColumn(n,a);t.assert(s instanceof e.MultiRowCellGroup,"Failed to get the group!");var u=a?s.getMergedRange(o,r-1,n):s.getMergedRange(o,r,n),c=o.columns.frozen;if(c&&u&&u.columnSpan>1&&u.col<c&&u.col2>=c){u=u.clone();n<c?u.col2=c-1:u.col=c}var d=o.rows.frozen;if(d&&u&&u.rowSpan>1&&o.cellType==t.grid.CellType.Cell&&u.row<d&&u.row2>=d){u=u.clone();r<d?u.row2=d-1:u.row=d}t.assert(!u||u.contains(r,n),"Merged range must contain source cell");return u;case t.grid.CellType.RowHeader:var p=l.rowsPerItem,f=r-o.rows[r].recordIndex,h=Math.min(f+p-1,o.rows.length-1);return new t.grid.CellRange(f,0,h,o.columns.length-1);case t.grid.CellType.TopLeft:var _=l.collapsedHeaders,w=o.rows.length-1,g=w>0?1:0,y=0!=_?0:g,R=1!=_?w:g;return new t.grid.CellRange(y,0,R,o.columns.length-1)}return null};_MergeManager.prototype._getGroupRowMergedRange=function(r,n,i,l,a){void 0===l&&(l=!0);var s=r.grid,u=r.cellType,c=r.rows[n];return s.showGroups&&!s.childItemsPath&&c instanceof e._MultiGroupRow&&c.dataItem instanceof t.collections.CollectionViewGroup&&u==t.grid.CellType.Cell?s._layout._getGroupHeaderMergedRange(r,n,i,a):o.prototype.getMergedRange.call(this,r,n,i,l)};return _MergeManager}(t.grid.MergeManager);e._MergeManager=o})((e=t.grid||(t.grid={})).multirow||(e.multirow={}))}(wijmo||(wijmo={}));!function(t){var e;(function(e){"use strict";var o=function(e){__extends(_MultiRowAddNewHandler,e);function _MultiRowAddNewHandler(t){t._addHdl._detach();return e.call(this,t)||this}_MultiRowAddNewHandler.prototype.updateNewRowTemplate=function(){for(var t=this._g.editableCollectionView,e=this._g,o=e.rows,n=t&&t.canAddNew&&e.allowAddNew&&!e.isReadOnly,i=-1,l=0;l<o.length;l+=e.rowsPerItem)if(o[l]instanceof r){i=l;break}if(n&&i>-1&&(this._top&&i>0||!this._top&&0==i)){i=-1;this._removeNewRowTemplate()}if(n&&i<0)for(l=0;l<e.rowsPerItem;l++){var a=new r(l);this._top?o.insert(l,a):o.push(a)}!n&&i>-1&&this._removeNewRowTemplate()};_MultiRowAddNewHandler.prototype._keydown=function(o){e.prototype._keydown.call(this,o);o.defaultPrevented||o.keyCode!=t.Key.Escape||this._copyNewDataItem()};_MultiRowAddNewHandler.prototype._beginningEdit=function(t,o){e.prototype._beginningEdit.call(this,t,o);this._top&&!t.rows[0].dataItem&&this._copyNewDataItem()};_MultiRowAddNewHandler.prototype._rowEditStarting=function(t,o){e.prototype._rowEditStarting.call(this,t,o);this._top&&!t.rows[0].dataItem&&this._copyNewDataItem()};_MultiRowAddNewHandler.prototype._rowEditEnded=function(t,o){e.prototype._rowEditEnded.call(this,t,o);this._copyNewDataItem()};_MultiRowAddNewHandler.prototype._copyNewDataItem=function(){if(this._top)for(var e=this._g,o=e.rows,r=0;r<e.rowsPerItem;r++)o[r]instanceof t.grid._NewRowTemplate&&(o[r].dataItem=this._nrt.dataItem)};_MultiRowAddNewHandler.prototype._removeNewRowTemplate=function(){for(var e=0,o=this._g.rows;e<o.length;e++)if(o[e]instanceof t.grid._NewRowTemplate){o.removeAt(e);e--}};return _MultiRowAddNewHandler}(t.grid._AddNewHandler);e._MultiRowAddNewHandler=o;var r=function(t){__extends(_MultiRowNewRowTemplate,t);function _MultiRowNewRowTemplate(e){var o=t.call(this)||this;o._idxRecord=e;return o}Object.defineProperty(_MultiRowNewRowTemplate.prototype,"recordIndex",{get:function(){return this._idxRecord},enumerable:!0,configurable:!0});return _MultiRowNewRowTemplate}(t.grid._NewRowTemplate);e._MultiRowNewRowTemplate=r})((e=t.grid||(t.grid={})).multirow||(e.multirow={}))}(wijmo||(wijmo={}));!function(t){!function(e){e.multirow||(e.multirow={}),t._registerModule("wijmo.grid.multirow",t.grid.multirow)}(t.grid||(t.grid={}))}(wijmo||(wijmo={}));