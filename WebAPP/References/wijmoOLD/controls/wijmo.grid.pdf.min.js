/*!
    *
    * Wijmo Library 5.20213.824
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

var wijmo,__extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(e){!function(t){!function(t){"use strict";t.softGrid=function softGrid(){return e._getModule("wijmo.grid")};t.softDetail=function softDetail(){return e._getModule("wijmo.grid.detail")};t.softMultiRow=function softMultiRow(){return e._getModule("wijmo.grid.multirow")};t.softSheet=function softSheet(){return e._getModule("wijmo.grid.sheet")};t.softOlap=function softOlap(){return e._getModule("wijmo.olap")};t.softTransposed=function softTransposed(){return e._getModule("wijmo.grid.transposed")};t.softTransposedMultiRow=function softTransposedMultiRow(){return e._getModule("wijmo.grid.transposedmultirow")}}(t.pdf||(t.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(e){!function(e){"use strict";!function(e){e[e.ActualSize=0]="ActualSize";e[e.PageWidth=1]="PageWidth";e[e.SinglePage=2]="SinglePage"}(e.ScaleMode||(e.ScaleMode={}));!function(e){e[e.All=0]="All";e[e.Selection=1]="Selection"}(e.ExportMode||(e.ExportMode={}))}(e.pdf||(e.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(e){!function(e){"use strict";!function(e){e[e.None=0]="None";e[e.Cell=1]="Cell";e[e.ColumnHeader=2]="ColumnHeader";e[e.RowHeader=3]="RowHeader";e[e.TopLeft=4]="TopLeft";e[e.ColumnFooter=5]="ColumnFooter";e[e.BottomLeft=6]="BottomLeft"}(e._CellType||(e._CellType={}))}(e.pdf||(e.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){!function(t){"use strict";t._merge=function _merge(t,r,o){void 0===o&&(o=!1);!t&&r&&(t={});if(r&&t)for(var n in r){var i=r[n],l=t[n];if(e.isObject(i)){if(void 0===l||!e.isObject(l)&&o){if(e.isFunction(i.clone)){t[n]=l=i.clone();continue}t[n]=l={}}e.isObject(l)&&_merge(t[n],i,o)}else(void 0===l||o&&void 0!==i)&&(t[n]=i)}return t};t._combineColumns=function _combineColumns(e,t){return{aggregate:t.aggregate,binding:t.binding,name:t.name,dataType:t.dataType,wordWrap:t.wordWrap,multiLine:t.multiLine,getAlignment:function(){if("getAlignment"in t)return t.getAlignment()},index:e.index,visibleIndex:e.visibleIndex,isVisible:e.isVisible,renderWidth:e.renderWidth}};t._cloneStyle=function _cloneStyle(e){if(!e)return null;for(var t={},toCamel=function(e){return e.replace(/\-([a-z])/g,(function(e,t,r){return r>0?t.toUpperCase():t}))},r=0,o=e.length;r<o;r++){var n=e[r];t[toCamel(n)]=e.getPropertyValue(n)}return t}}(t.pdf||(t.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){!function(t){!function(t){"use strict";var r=function(t){__extends(PdfFormatItemEventArgs,t);function PdfFormatItemEventArgs(r,o,n,i,l,s,a,d,u){var f=t.call(this)||this;f.cancelBorders=!1;f._p=r;f._rng=o;"undefined"!=typeof HTMLElement&&(f._cell=e.asType(n,HTMLElement,!0));f._canvas=i;f._clientRect=l;f._contentRect=s;f._style=a;f._getFormattedCell=d;f._getTextRect=u;return f}Object.defineProperty(PdfFormatItemEventArgs.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"range",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"clientRect",{get:function(){return this._clientRect},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!0,configurable:!0});PdfFormatItemEventArgs.prototype.drawBackground=function(e){var t=this.clientRect;e&&t.width>0&&t.height>0&&this.canvas.paths.rect(t.left,t.top,t.width,t.height).fill(e||this.style.backgroundColor)};PdfFormatItemEventArgs.prototype.getFormattedCell=function(){return e.asFunction(this._getFormattedCell)()};Object.defineProperty(PdfFormatItemEventArgs.prototype,"tagContent",{get:function(){return this._tagContent},set:function(e){this._tagContent=e},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0});Object.defineProperty(PdfFormatItemEventArgs.prototype,"textTop",{get:function(){!this._textRect&&e.isFunction(this._getTextRect)&&(this._textRect=this._getTextRect());return this._textRect?this._textRect.top:this._contentRect.top},enumerable:!0,configurable:!0});return PdfFormatItemEventArgs}(e.CancelEventArgs);t.PdfFormatItemEventArgs=r}(t.pdf||(t.pdf={}))}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var r=function(){function _FlexGridPdfCoreConverter(){}_FlexGridPdfCoreConverter.draw=function(r,o,n,i,l,s){e.assert(!!r,"The flex argument cannot be null.");e.assert(!!o,"The doc argument cannot be null.");null==(s=this._applyDefaultDrawSettings(s)).scaleMode&&(s.scaleMode=null==i?t.ScaleMode.ActualSize:null==l?t.ScaleMode.PageWidth:t.ScaleMode.SinglePage);this._drawInternal(r,o,n,i,l,s)};_FlexGridPdfCoreConverter._applyDefaultDrawSettings=function(e){return t._merge(t._merge({},e),_FlexGridPdfCoreConverter.DefaultDrawSettings)};_FlexGridPdfCoreConverter._drawInternal=function(t,r,n,i,l,s){var a=null!=n,d=new e.Size(r.width,r.height);n||(n=new e.Point(0,r.y));e.isArray(s.embeddedFonts)&&s.embeddedFonts.forEach((function(e){r.registerFont(e)}));var u=this._getRowsToRender(t,s),f=new o(t,s,u,this.BorderWidth,!0),p=new e.Rect(n.x||0,n.y||0,i||d.width,l||d.height),c=this._getScaleFactor(f,s.scaleMode,p);if(n.y>0&&this._canBreakRows(s.scaleMode)){var h=u.find(t.cells,(function(e){return f.isRenderableRow(e)}));if(h){var g=(p.height-p.top)*(1/c);if((f.showColumnHeader?e.pdf.pxToPt(t.columnHeaders.height):0)+e.pdf.pxToPt(h.renderHeight)-this.BorderWidth>g){r.addPage();p=new e.Rect(n.x||0,0,i||d.width,l||d.height)}}}var _=this._getPages(f,u,p,s,a,c),w=(s.progress?this._getCellsCount(t,s,_):0)/s._progressMax,m=0,b=0,C=s.progress?function(){if(++m-b>=50){b=m;s.progress(m/w)}}:null;s.progress&&s.progress(0);for(var y=0;y<_.length;y++){y>0&&r.addPage();var R=_[y],x=0===R.pageCol?p.left:0,v=0===R.pageRow?p.top:0;r.saveState();r.paths.rect(0,0,r._widthCtm,r._heightCtm).clip();r.scale(c,c,new e.Point(x,v));r.translate(x,v);var P=new o(t,s,R.range,this.BorderWidth,y===_.length-1);P.render(r,C);r.restoreState();r.x=x;r.y=v+P.renderSize.height*c}s.progress&&0<s._progressMax&&s.progress(s._progressMax)};_FlexGridPdfCoreConverter._getCellsCount=function(e,t,r){for(var n=0,i=0;i<r.length;i++)n+=new o(e,t,r[i].range,0,!1).getCellsCount();return n};_FlexGridPdfCoreConverter._getRowsToRender=function(e,r){var o=[];r.exportMode==t.ExportMode.All?o.push(new a(0,0,e.rows.length-1,e.columns.length-1)):o=e.getSelection();var n=new u(o);if(n.isValid&&!r.drawDetailRows){var i=[];n.forEach(e.cells,(function(t,r,o){if(!e.isDetailRow(t)){var n=i.length;n&&i[n-1].bottomRow+1===o?i[n-1].row2++:i.push(new a(o,r.col,o,r.col2))}}));n=new u(i)}return n};_FlexGridPdfCoreConverter._getScaleFactor=function(e,r,o){var n=1;if(r==t.ScaleMode.ActualSize)return n;var i=e.renderSize;if(r==t.ScaleMode.SinglePage)(l=Math.min(o.width/i.width,o.height/i.height))<1&&(n=l);else{var l;(l=o.width/i.width)<1&&(n=l)}return n};_FlexGridPdfCoreConverter._canBreakRows=function(e){return e==t.ScaleMode.ActualSize||e==t.ScaleMode.PageWidth};_FlexGridPdfCoreConverter._getPages=function(r,o,n,i,l,s){var d=this,p=[],c=[],h=e.pdf.pxToPt,g=r.flex,_=r.showColumnHeader,w=r.showColumnFooter,m=r.showRowHeader,b=_?h(g.columnHeaders.height):0,C=w?h(g.columnFooters.height):0,y=m?h(g.rowHeaders.width):0,R=this._canBreakRows(i.scaleMode),x=i.scaleMode==t.ScaleMode.ActualSize,v=(n.width-n.left)*(1/s),P=(n.height-n.top)*(1/s),T=n.width*(1/s),S=n.height*(1/s),G=b,F=y,A=l&&i.scaleMode==t.ScaleMode.ActualSize,M=P;if(R){var W=0,H=0;o.forEach(g.cells,(function(e,t,o,n){M=p.length?S:P;if(r.isRenderableRow(e)){var i=h(e.renderHeight);W++;G+=i;(_||W>1)&&(G-=d.BorderWidth);if(G>M){if(A||b+i>M&&0===H){p.push(n);G=b}else{p.push(n-1);G=b+i}H=0;_&&(G-=d.BorderWidth)}else H++}}))}var j=Math.max(o.length()-1,0);p.length&&p[p.length-1]===j||p.push(j);w&&G+C>M&&p.push(-1);if(x)for(var z=0,J=o.leftCol;J<=o.rightCol;J++){var O=g.columns[J];if(r.isRenderableColumn(O)){var E=h(O.renderWidth),L=c.length?T:v;z++;F+=E;(m||z>1)&&(F-=this.BorderWidth);if(F>L){if(y+E>L||A){c.push(J);F=y}else{c.push(J-1);F=y+E}m&&(F-=this.BorderWidth)}}}c.length&&c[c.length-1]===o.rightCol||c.push(o.rightCol);var D=[],B=!1,k=1,I=l&&i.maxPages>0?1:i.maxPages;for(J=0;J<p.length&&!B;J++)for(var V=0;V<c.length&&!B;V++,k++)if(!(B=k>I)){var N=0===J?0:p[J-1]+1,U=0===V?o.leftCol:c[V-1]+1,q=-1===p[J]?new u([new a(-1,U,-1,c[V])]):o.subrange(N,p[J]-N+1,U,c[V]);D.push(new f(q,V,J))}return D};_FlexGridPdfCoreConverter.BorderWidth=1;_FlexGridPdfCoreConverter.DefFont=new e.pdf.PdfFont;_FlexGridPdfCoreConverter.DefaultDrawSettings={customCellContent:!1,drawDetailRows:!1,exportMode:t.ExportMode.All,maxPages:Number.MAX_VALUE,repeatMergedValuesAcrossPages:!0,recalculateStarWidths:!0,styles:{cellStyle:{font:{family:_FlexGridPdfCoreConverter.DefFont.family,size:_FlexGridPdfCoreConverter.DefFont.size,style:_FlexGridPdfCoreConverter.DefFont.style,weight:_FlexGridPdfCoreConverter.DefFont.weight},padding:1.5,verticalAlign:"middle"},headerCellStyle:{font:{weight:"bold"}}},quickCellStyles:!0,_progressMax:1};return _FlexGridPdfCoreConverter}();t._FlexGridPdfCoreConverter=r;var o=function(){function FlexGridRenderer(e,t,r,o,i){this._flex=e;this._borderWidth=o;this._lastPage=i;this._settings=t||{};this._topLeft=new n(this,e.topLeftCells,this.showRowHeader&&this.showColumnHeader?new u([new a(0,0,e.topLeftCells.rows.length-1,e.topLeftCells.columns.length-1)]):new u([]),o);this._rowHeader=new n(this,e.rowHeaders,this.showRowHeader?r.clone(0,e.rowHeaders.columns.length-1):new u([]),o);this._columnHeader=new n(this,e.columnHeaders,this.showColumnHeader?new u([new a(0,r.leftCol,e.columnHeaders.rows.length-1,r.rightCol)]):new u([]),o);this._cells=new n(this,e.cells,r,o);this._bottomLeft=new n(this,e.bottomLeftCells,this.showRowHeader&&this.showColumnFooter?new u([new a(0,0,e.bottomLeftCells.rows.length-1,e.bottomLeftCells.columns.length-1)]):new u([]),o);this._columnFooter=new n(this,e.columnFooters,this.showColumnFooter?new u([new a(0,r.leftCol,e.columnFooters.rows.length-1,r.rightCol)]):new u([]),o)}Object.defineProperty(FlexGridRenderer.prototype,"settings",{get:function(){return this._settings},enumerable:!0,configurable:!0});FlexGridRenderer.prototype.isRenderableRow=function(e){return this._flex.isRenderableRow(e)};FlexGridRenderer.prototype.isRenderableColumn=function(e){return this._flex.isRenderableColumn(e)};FlexGridRenderer.prototype.getCellsCount=function(){return this._topLeft.getCellsCount()+this._rowHeader.getCellsCount()+this._columnHeader.getCellsCount()+this._cells.getCellsCount()+this._bottomLeft.getCellsCount()+this._columnFooter.getCellsCount()};FlexGridRenderer.prototype.render=function(t,r){var o,n,l,s;if(t.tagged){o=n=l=s=new i(t,t.tag(e.pdf.PdfTagType.Table));t.addTag(o.el);if(t.version>=e.pdf.PdfVersion.v1_5){o.el.add((n=new i(t,t.tag(e.pdf.PdfTagType.THead))).el);o.el.add((l=new i(t,t.tag(e.pdf.PdfTagType.TBody))).el);o.el.add((s=new i(t,t.tag(e.pdf.PdfTagType.TFoot))).el)}}var a=Math.max(0,Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)-this._borderWidth),d=Math.max(0,Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)-this._borderWidth);this._topLeft.render(t,0,0,r,n);this._rowHeader.render(t,0,d,r,l);this._columnHeader.render(t,a,0,r,n);this._cells.render(t,a,d,r,l);d+=Math.max(0,this._cells.renderSize.height-this._borderWidth);this._bottomLeft.render(t,0,d,r,s);this._columnFooter.render(t,a,d,r,s)};Object.defineProperty(FlexGridRenderer.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridRenderer.prototype,"renderSize",{get:function(){var t=Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)+Math.max(this._rowHeader.renderSize.height,this._cells.renderSize.height)+Math.max(this._bottomLeft.renderSize.height,this._columnFooter.renderSize.height),r=Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)+Math.max(this._columnHeader.renderSize.width,this._cells.renderSize.width);this._columnHeader.renderableRowsCount>0&&(t-=this._borderWidth);this._columnFooter.renderableRowsCount>0&&(t-=this._borderWidth);this._rowHeader.renderableColumnsCount>0&&(r-=this._borderWidth);return new e.Size(r,t)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridRenderer.prototype,"showColumnHeader",{get:function(){return this._flex.showColumnHeader},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridRenderer.prototype,"showRowHeader",{get:function(){return this._flex.showRowHeader},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridRenderer.prototype,"showColumnFooter",{get:function(){return this._lastPage&&this._flex.showColumnFooter},enumerable:!0,configurable:!0});FlexGridRenderer.prototype.alignMergedTextToTheTopRow=function(e){return this._flex.alignMergedTextToTheTopRow(e)};FlexGridRenderer.prototype.getColumn=function(e,t,r){return this._flex.getColumn(e,t,r)};FlexGridRenderer.prototype.isAlternatingRow=function(e){return this._flex.isAlternatingRow(e)};FlexGridRenderer.prototype.isGroupRow=function(e){return this._flex.isGroupRow(e)};FlexGridRenderer.prototype.isNewRow=function(e){return this._flex.isNewRow(e)};FlexGridRenderer.prototype.isExpandableGroupRow=function(e){return this._flex.isExpandableGroupRow(e)};FlexGridRenderer.prototype.isBooleanCell=function(e,t,r){return this._flex.isBooleanCell(e,t,r)};FlexGridRenderer.prototype.getCellStyle=function(e,t,r){return this._flex.getCellStyle(e,t,r)};return FlexGridRenderer}(),n=function(r){__extends(PanelSectionRenderer,r);function PanelSectionRenderer(e,t,o,n){var i=r.call(this,e.flex,t,o)||this;i._gr=e;i._borderWidth=n;return i}Object.defineProperty(PanelSectionRenderer.prototype,"gr",{get:function(){return this._gr},enumerable:!0,configurable:!0});Object.defineProperty(PanelSectionRenderer.prototype,"renderSize",{get:function(){if(null==this._renderSize){this._renderSize=this.size.clone();this.renderableColumnsCount>1&&(this._renderSize.width-=this._borderWidth*(this.renderableColumnsCount-1));this.renderableRowsCount>1&&(this._renderSize.height-=this._borderWidth*(this.renderableRowsCount-1))}return this._renderSize},enumerable:!0,configurable:!0});PanelSectionRenderer.prototype._getRangeWidth=function(t,r){for(var o=0,n=0,i=this.panel,l=t;l<=r;l++){var s=i.columns[l];if(this._gr.isRenderableColumn(s)){n++;o+=s.renderWidth}}o=e.pdf.pxToPt(o);n>1&&(o-=this._borderWidth*(n-1));return o};PanelSectionRenderer.prototype._getRangeHeight=function(t,r){for(var o=0,n=0,i=this.panel,l=t;l<=r;l++){var s=i.rows[l];if(this._gr.isRenderableRow(s)){n++;o+=s.renderHeight}}o=e.pdf.pxToPt(o);n>1&&(o-=this._borderWidth*(n-1));return o};PanelSectionRenderer.prototype.getCellsCount=function(){var e=this,t=0,r=this.range,o=this.panel,n=new s(this._gr.flex);if(!r.isValid)return t;r.forEach(o,(function(i,l,s){if(e._gr.isRenderableRow(i))for(var a=r.leftCol;a<=r.rightCol;a++)if(e._gr.isRenderableColumn(o.columns[a])){var d=!1,u=void 0,f=n.getMergedRange(o,s,a);if(f){var p=s===f.firstVisibleRow,c=a===f.leftCol,h=s===l.topRow,g=a===l.leftCol,_=f.rowSpan>1,w=f.columnSpan>1;if(_&&w&&(p&&c||h&&g)||_&&!w&&(p||h)||!_&&w&&(c||g)){d=!0;w&&(u=Math.min(r.rightCol,f.rightCol))}}else d=!0;d&&t++;u&&(a=u)}}));return t};PanelSectionRenderer.prototype.render=function(r,o,n,i,a){var u=this,f=this.range;if(f.isValid){for(var p={},c=this.panel,h=new s(this._gr.flex),g=new d(c,0,0,0,0),_=new l(this,r,this._borderWidth),w=f.leftCol;w<=f.rightCol;w++)p[w]=n;f.forEach(c,(function(n,l,s){if(u._gr.isRenderableRow(n))for(var d=a?a.getTR(s,c.cellType):null,w=o,m=f.leftCol;m<=f.rightCol;m++){var b=u.gr.getColumn(c,s,m);if(u._gr.isRenderableColumn(b)){var C,y=void 0,R=void 0,x=!1,v=void 0,P=u._gr.flex.getCellContent(u.panel,n,b,m),T=h.getMergedRange(c,s,m);if(T){g.copyFrom(T);var S=s===T.firstVisibleRow,G=m===T.leftCol,F=s===l.topRow,A=m===l.leftCol,M=T.rowSpan>1,W=T.columnSpan>1;if(M&&W&&(S&&G||F&&A)||M&&!W&&(S||F)||!M&&W&&(G||A)){x=!0;C=S&&G||u.gr.settings.repeatMergedValuesAcrossPages?P:"";y=M?u._getRangeHeight(s,Math.min(T.bottomRow,l.bottomRow)):u._getRangeHeight(s,s);if(W){R=u._getRangeWidth(Math.max(f.leftCol,T.leftCol),Math.min(f.rightCol,T.rightCol));v=Math.min(f.rightCol,T.rightCol);for(var H=m+1;H<=v;H++)p[H]+=y-u._borderWidth}}null==R&&(R=u._getRangeWidth(m,m))}else{g.setRange(s,m,s,m);x=!0;C=P;y=u._getRangeHeight(s,s);R=u._getRangeWidth(m,m)}if(x&&R>0&&y>0){var j=_.renderCell(C,n,b,g,new e.Rect(w,p[m],R,y));if(d){var z=r.tag(c.cellType===t._CellType.ColumnHeader||c.cellType==t._CellType.TopLeft?e.pdf.PdfTagType.TH:e.pdf.PdfTagType.TD);j&&z.add(j);d.add(z)}i&&i()}y&&(p[m]+=y-u._borderWidth);R&&(w+=R-u._borderWidth);v&&(m=v)}}}))}};return PanelSectionRenderer}(function(){function PanelSection(e,t,r){this._flex=e;this._panel=t;this._range=r.clone()}Object.defineProperty(PanelSection.prototype,"renderableRowsCount",{get:function(){var e=this;if(null==this._renderableRowsCnt){this._renderableRowsCnt=0;this._range.forEach(this._panel,(function(t){e._flex.isRenderableRow(t)&&e._renderableRowsCnt++}))}return this._renderableRowsCnt},enumerable:!0,configurable:!0});Object.defineProperty(PanelSection.prototype,"renderableColumnsCount",{get:function(){if(null==this._renderableColumnsCnt){this._renderableColumnsCnt=0;if(this._range.isValid)for(var e=this._range.leftCol;e<=this._range.rightCol;e++)this._flex.isRenderableColumn(this._panel.columns[e])&&this._renderableColumnsCnt++}return this._renderableColumnsCnt},enumerable:!0,configurable:!0});Object.defineProperty(PanelSection.prototype,"size",{get:function(){if(null==this._size){var t=this._range.getRenderSize(this._flex,this._panel);this._size=new e.Size(e.pdf.pxToPt(t.width),e.pdf.pxToPt(t.height))}return this._size},enumerable:!0,configurable:!0});Object.defineProperty(PanelSection.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0});Object.defineProperty(PanelSection.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0});return PanelSection}()),i=function(){function TrStructCache(e,t){this.doc=e;this.tableSection=t;this._trh=[];this._trb=[];this._trf=[]}Object.defineProperty(TrStructCache.prototype,"el",{get:function(){return this.tableSection},enumerable:!0,configurable:!0});TrStructCache.prototype.getTR=function(r,o){var n=o===t._CellType.TopLeft||o===t._CellType.ColumnHeader?this._trh:o===t._CellType.RowHeader||o===t._CellType.Cell?this._trb:this._trf,i=n[r];i||this.tableSection.add(n[r]=i=this.doc.tag(e.pdf.PdfTagType.TR));return i};return TrStructCache}(),l=function(){function _CellRenderer(t,r,o){this.InvisiblePen=new e.pdf.PdfPen(e.Color.fromRgba(0,0,0,0),0);this._pr=t;this._area=r;this._borderWidth=o}_CellRenderer.prototype.renderCell=function(r,o,n,i,l){var s,a=this,d=this._pr.gr.flex,u=this._pr.panel,getGridCell=function(e){return d.getCell(u,i.topRow,i.leftCol,e)},f=null,p=this._pr.gr.getCellStyle(u,o,n),c=this._pr.gr.settings.customCellContent,h=e.isFunction(this._pr.gr.settings.formatItem);if(c){var g=d.getComputedStyle(u,f=getGridCell(h));p.color=g.color;p.backgroundColor=g.backgroundColor;var _=d.getComputedDefBorderColor();p.borderLeftColor="none"!=g.borderLeftStyle?g.borderLeftColor:_;p.borderRightColor="none"!=g.borderRightStyle?g.borderRightColor:_;p.borderTopColor="none"!=g.borderTopStyle?g.borderTopColor:_;p.borderBottomColor="none"!=g.borderBottomStyle?g.borderBottomColor:_;p.font=new e.pdf.PdfFont(g.fontFamily,e.pdf._asPt(g.fontSize,!0,void 0),g.fontStyle,g.fontWeight);p.textAlign=g.textAlign}if(p.font&&!(p.font instanceof e.pdf.PdfFont)){var w=p.font;p.font=new e.pdf.PdfFont(w.family,w.size,w.style,w.weight)}p.boxSizing="border-box";p.borderWidth=this._borderWidth;p.borderStyle="solid";c||this._pr.gr.isExpandableGroupRow(o)&&0===n.visibleIndex||(p.textAlign=n.getAlignment(o));if(u.cellType===t._CellType.Cell&&d.rows.maxGroupLevel>=0&&i.leftCol===d.columns.firstVisibleIndex){var m=d.isGroupRow(o)?Math.max(o.level,0):d.rows.maxGroupLevel+1,b=e.pdf._asPt(p.paddingLeft||p.padding),C=e.pdf.pxToPt(m*d.treeIndent);p.paddingLeft=b+C}var y,R=this._measureCell(r,u,o,n,p,l),x=i.rowSpan>1&&i.visibleRowsCount>1&&this._pr.gr.alignMergedTextToTheTopRow(u)?new e.Rect(R.contentRect.left,R.contentRect.top,R.contentRect.width,R.contentRect.height/(i.visibleRowsCount||1)):R.contentRect,v=!0,P=!0;if(h){(s=new t.PdfFormatItemEventArgs(u,i,f,this._area,R.rect,R.contentRect,p,(function(){return f||getGridCell(!0)}),(function(){return R.textRect=a._calculateTextRect(r,u,o,n,x,p)}))).data=r;this._pr.gr.settings.formatItem(s);if(s.data!==r){r=e.asString(s.data);R.textRect=null}v=!s.cancel;P=!s.cancelBorders;y=s.tagContent}v&&!R.textRect&&(R.textRect=this._calculateTextRect(r,u,o,n,x,p));return this._renderCell(r,o,n,i,R,p,v,P,null==y)||y};_CellRenderer.prototype._renderCell=function(t,r,o,n,i,l,s,a,d){if(s||a){var u,f=this._area.document.tagged,p=this._area.document;f&&p.beginArtifact({type:e.pdf.PdfArtifactType.Layout});this._renderEmptyCell(i,l,s,a);f&&p.endArtifact();if(s){d=!0===f&&!0===d;var c=void 0;if(this._isBooleanCellAndValue(t,this._pr.panel,r,o)){if(d){u=p.tag(e.pdf.PdfTagType.Span,null,{actual:t.toString()});c=p.beginTagContent(e.pdf.PdfTagType.Span)}this._renderBooleanCell(t,i,l)}else{if(d){u=p.tag(e.pdf.PdfTagType.P);c=p.beginTagContent(e.pdf.PdfTagType.P)}this._renderTextCell(t,i,l)}if(d){p.endTagContent();u.add(c)}}return u}};_CellRenderer.prototype._isBooleanCellAndValue=function(e,t,r,o){return this._pr.gr.isBooleanCell(t,r,o)&&this._isBoolean(e)};_CellRenderer.prototype._isBoolean=function(t){var r=e.isString(t)&&t.toLowerCase();return"true"===r||"false"===r||!0===t||!1===t};_CellRenderer.prototype._measureCell=function(t,r,o,n,i,l){this._decompositeStyle(i);var s=l.left,a=l.top,d=l.height,u=l.width,f=this._parseBorder(i),p=f.left.width,c=f.top.width,h=f.bottom.width,g=f.right.width,_=this._parsePadding(i),w=0,m=0,b=0,C=0;if("content-box"===i.boxSizing||void 0===i.boxSizing){w=_.top+d+_.bottom;m=_.left+u+_.right;b=d;C=u}else{if("border-box"!==i.boxSizing)throw"Invalid value: "+i.boxSizing;if(e.pdf._IE&&i instanceof CSSStyleDeclaration){w=_.top+_.bottom+d;m=_.left+_.right+u}else{w=Math.max(d-c-h,0);m=Math.max(u-p-g,0)}b=Math.max(w-_.top-_.bottom,0);C=Math.max(m-_.left-_.right,0)}return{rect:l=new e.Rect(s,a,u,d),clientRect:new e.Rect(s+p,a+c,m,w),contentRect:new e.Rect(s+p+_.left,a+c+_.top,C,b),textRect:null}};_CellRenderer.prototype._decompositeStyle=function(e){if(e){var t;if(t=e.borderColor){e.borderLeftColor||(e.borderLeftColor=t);e.borderRightColor||(e.borderRightColor=t);e.borderTopColor||(e.borderTopColor=t);e.borderBottomColor||(e.borderBottomColor=t)}if(t=e.borderWidth){e.borderLeftWidth||(e.borderLeftWidth=t);e.borderRightWidth||(e.borderRightWidth=t);e.borderTopWidth||(e.borderTopWidth=t);e.borderBottomWidth||(e.borderBottomWidth=t)}if(t=e.borderStyle){e.borderLeftStyle||(e.borderLeftStyle=t);e.borderRightStyle||(e.borderRightStyle=t);e.borderTopStyle||(e.borderTopStyle=t);e.borderBottomStyle||(e.borderBottomStyle=t)}if(t=e.padding){e.paddingLeft||(e.paddingLeft=t);e.paddingRight||(e.paddingRight=t);e.paddingTop||(e.paddingTop=t);e.paddingBottom||(e.paddingBottom=t)}}};_CellRenderer.prototype._parseBorder=function(t){var r={left:{width:0},top:{width:0},bottom:{width:0},right:{width:0}};"none"!==t.borderLeftStyle&&(r.left={width:e.pdf._asPt(t.borderLeftWidth),style:t.borderLeftStyle,color:t.borderLeftColor});"none"!==t.borderTopStyle&&(r.top={width:e.pdf._asPt(t.borderTopWidth),style:t.borderTopStyle,color:t.borderTopColor});"none"!==t.borderBottomStyle&&(r.bottom={width:e.pdf._asPt(t.borderBottomWidth),style:t.borderBottomStyle,color:t.borderBottomColor});"none"!==t.borderRightStyle&&(r.right={width:e.pdf._asPt(t.borderRightWidth),style:t.borderRightStyle,color:t.borderRightColor});return r};_CellRenderer.prototype._parsePadding=function(t){return{left:e.pdf._asPt(t.paddingLeft),top:e.pdf._asPt(t.paddingTop),bottom:e.pdf._asPt(t.paddingBottom),right:e.pdf._asPt(t.paddingRight)}};_CellRenderer.prototype._renderEmptyCell=function(t,r,o,n){var i=t.rect.left,l=t.rect.top,s=t.clientRect.width,a=t.clientRect.height,d=t.clientRect.left-t.rect.left,u=t.clientRect.top-t.rect.top,f=t.rect.top+t.rect.height-(t.clientRect.top+t.clientRect.height),p=t.rect.left+t.rect.width-(t.clientRect.left+t.clientRect.width);o=o&&r.backgroundColor&&s>0&&a>0;if(n&&(d||p||f||u)){var c=r.borderLeftColor||r.borderColor,h=r.borderRightColor||r.borderColor,g=r.borderTopColor||r.borderColor,_=r.borderBottomColor||r.borderColor;if(d&&u&&f&&p&&d===p&&d===f&&d===u&&c===h&&c===_&&c===g){var w=d,m=w/2,b=this._area.paths.rect(i+m,l+m,s+w,a+w);if(o){b.fillAndStroke(r.backgroundColor,new e.pdf.PdfPen(c,w));return}b.stroke(new e.pdf.PdfPen(c,w))}else{d&&this._area.paths.polygon([[i,l],[i+d,l+u],[i+d,l+u+a],[i,l+u+a+f]]).fill(c);u&&this._area.paths.polygon([[i,l],[i+d,l+u],[i+d+s,l+u],[i+d+s+p,l]]).fill(g);p&&this._area.paths.polygon([[i+d+s+p,l],[i+d+s,l+u],[i+d+s,l+u+a],[i+d+s+p,l+u+a+f]]).fill(h);f&&this._area.paths.polygon([[i,l+u+a+f],[i+d,l+u+a],[i+d+s,l+u+a],[i+d+s+p,l+u+a+f]]).fill(_)}}o&&this._area.paths.rect(t.clientRect.left,t.clientRect.top,t.clientRect.width,t.clientRect.height).fillAndStroke(r.backgroundColor,this.InvisiblePen)};_CellRenderer.prototype._renderBooleanCell=function(t,r,o){if(!(!r.textRect||r.textRect.height<=0||r.textRect.width<=0)){var n=r.textRect.left,i=r.textRect.top,l=r.textRect.height;this._area.paths.rect(n,i,l,l).fillAndStroke(e.Color.fromRgba(255,255,255),new e.pdf.PdfPen(void 0,.5));if(!0===e.changeType(t,e.DataType.Boolean,"")){var s=l/20,a=l-.5-2*s,d=l/8;this._area.document.saveState();this._area.translate(n+.25+s,i+.25+s).paths.moveTo(d/2,.6*a).lineTo(a-.6*a,a-d).lineTo(a-d/2,d/2).stroke(new e.pdf.PdfPen(void 0,d));this._area.document.restoreState()}}};_CellRenderer.prototype._renderTextCell=function(t,r,o){!t||!r.textRect||r.textRect.height<=0||r.textRect.width<=0||this._area.drawText(t,r.textRect.left,r.textRect.top,{brush:o.color,font:o.font,height:r.textRect.height,width:r.textRect.width,align:"center"===o.textAlign?e.pdf.PdfTextHorizontalAlign.Center:"right"===o.textAlign?e.pdf.PdfTextHorizontalAlign.Right:"justify"===o.textAlign?e.pdf.PdfTextHorizontalAlign.Justify:e.pdf.PdfTextHorizontalAlign.Left})};_CellRenderer.prototype._calculateTextRect=function(t,r,o,n,i,l){if(null!=t&&!e.isString(t))return null;var s=i.clone();if(this._isBooleanCellAndValue(t,r,o,n)){var a=this._getTextLineHeight(l.font);switch(l.verticalAlign){case"middle":s.top=i.top+i.height/2-a/2;break;case"bottom":s.top=i.top+i.height-a}switch(l.textAlign){case"justify":case"center":s.left=i.left+i.width/2-a/2;break;case"right":s.left=i.left+i.width-a}s.height=s.width=a}else if(s.height>0&&s.width>0)switch(l.verticalAlign){case"bottom":if((u=this._area.measureText(t,l.font,{height:s.height,width:s.width})).size.height<s.height){var d=(f=this._area.document._document).currentLineHeight(!0)-f.currentLineHeight(!1);s.top+=s.height-u.size.height-d;s.height=u.size.height}break;case"middle":var u;if((u=this._area.measureText(t,l.font,{height:s.height,width:s.width})).size.height<s.height){var f;d=(f=this._area.document._document).currentLineHeight(!0)-f.currentLineHeight(!1);s.top+=s.height/2-(u.size.height-d)/2;s.height=u.size.height}}return s};_CellRenderer.prototype._getTextLineHeight=function(e){return this._area.lineHeight(e)};return _CellRenderer}();t._CellRenderer=l;var s=function(){function GetMergedRangeProxy(e){this._columns={};this._flex=e}GetMergedRangeProxy.prototype.getMergedRange=function(e,t,r){var o=this._columns[r];if(o&&t>=o.topRow&&t<=o.bottomRow)return o;var n=this._flex.getMergedRange(e,t,r),i=e.columns,l=e.rows;if(n&&!n.isSingleCell&&(!i[n.col].isVisible||!i[n.col2].isVisible||!l[n.row].isVisible||!l[n.row2].isVisible)){n=n.clone();for(;n.col<n.col2&&!i[n.col].isVisible;)n.col++;for(;n.col2>n.col&&!i[n.col2].isVisible;)n.col2--;for(;n.row<n.row2&&!l[n.row].isVisible;)n.row++;for(;n.row2>n.row&&!l[n.row2].isVisible;)n.row2--}n&&n.isSingleCell&&(n=null);return this._columns[r]=n?new d(e,n):null};return GetMergedRangeProxy}(),a=function(){function _CellRange(e,t,r,o){if("number"==typeof e){this._row=e;this._col=t;this._row2=r;this._col2=o}else{this._row=e.row;this._col=e.col;this._row2=e.row2;this._col2=e.col2}(this._row<0||this._row2<0)&&(this._row=this._row2=-1);(this._col<0||this._col2<0)&&(this._col=this._col2=-1)}Object.defineProperty(_CellRange.prototype,"row",{get:function(){return this._row},set:function(e){this._row=e},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"col",{get:function(){return this._col},set:function(e){this._col=e},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"row2",{get:function(){return this._row2},set:function(e){this._row2=e},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"col2",{get:function(){return this._col2},set:function(e){this._col2=e},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"columnSpan",{get:function(){return Math.abs(this._col2-this._col)+1},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0});Object.defineProperty(_CellRange.prototype,"isSingleCell",{get:function(){return this._row===this._row2&&this._col===this._col2},enumerable:!0,configurable:!0});_CellRange.prototype.copyFrom=function(e){this.setRange(e.row,e.col,e.row2,e.col2)};_CellRange.prototype.clone=function(){return new _CellRange(this._row,this._col,this._row2,this._col2)};_CellRange.prototype.getRenderSize=function(t,r){var o=new e.Size(0,0);if(this.isValid){for(var n=this.topRow;n<=this.bottomRow;n++){var i=r.rows[n];t.isRenderableRow(i)&&(o.height+=i.renderHeight)}for(var l=this.leftCol;l<=this.rightCol;l++){var s=r.columns[l];t.isRenderableColumn(s)&&(o.width+=s.renderWidth)}}return o};_CellRange.prototype.setRange=function(t,r,o,n){void 0===t&&(t=-1);void 0===r&&(r=-1);void 0===o&&(o=t);void 0===n&&(n=r);this._row=e.asInt(t);this._col=e.asInt(r);this._row2=e.asInt(o);this._col2=e.asInt(n)};return _CellRange}();t._CellRange=a;var d=function(e){__extends(_CellRangeExt,e);function _CellRangeExt(t,r,o,n,i){var l=e.call(this,r,o,n,i)||this;l.firstVisibleRow=-1;l.visibleRowsCount=0;if(t){var s=l.topRow,a=l.bottomRow,d=t.rows.length;if(d>0)for(var u=s;u<=a&&u<d;u++)if(t.rows[u].isVisible){l.firstVisibleRow<0&&(l.firstVisibleRow=u);l.visibleRowsCount++}}return l}_CellRangeExt.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t);this.firstVisibleRow=t.firstVisibleRow;this.visibleRowsCount=t.visibleRowsCount};_CellRangeExt.prototype.clone=function(){return new _CellRangeExt(null,this.row,this.col,this.row2,this.col2)};return _CellRangeExt}(a);t._CellRangeExt=d;var u=function(){function RowRange(e){this._ranges=e||[]}RowRange.prototype.length=function(){for(var e=0,t=0;t<this._ranges.length;t++){var r=this._ranges[t];r.isValid&&(e+=r.bottomRow-r.topRow+1)}return e};Object.defineProperty(RowRange.prototype,"isValid",{get:function(){return this._ranges.length&&this._ranges[0].isValid},enumerable:!0,configurable:!0});Object.defineProperty(RowRange.prototype,"leftCol",{get:function(){return this._ranges.length?this._ranges[0].leftCol:-1},enumerable:!0,configurable:!0});Object.defineProperty(RowRange.prototype,"rightCol",{get:function(){return this._ranges.length?this._ranges[0].rightCol:-1},enumerable:!0,configurable:!0});RowRange.prototype.clone=function(e,t){for(var r=[],o=0;o<this._ranges.length;o++){var n=this._ranges[o].clone();arguments.length>0&&(n.col=e);arguments.length>1&&(n.col2=t);r.push(n)}return new RowRange(r)};RowRange.prototype.getRenderSize=function(t,r){for(var o=new e.Size(0,0),n=0;n<this._ranges.length;n++){var i=this._ranges[n].getRenderSize(t,r);o.width=Math.max(o.width,i.width);o.height+=i.height}return o};RowRange.prototype.find=function(e,t){var r=null;this.forEach(e,(function(e){if(!0===t(e)){r=e;return!1}}));return r};RowRange.prototype.forEach=function(e,t){for(var r=0,o=!1,n=0;n<this._ranges.length&&!o;n++){var i=this._ranges[n];if(i.isValid)for(var l=i.topRow;l<=i.bottomRow&&!o;l++)o=!1===t(e.rows[l],i,l,r++)}};RowRange.prototype.subrange=function(e,t,r,o){var n=[];if(e>=0&&t>0)for(var i=0,l=0,s=0;s<this._ranges.length&&t>0;s++,i=l+1){var d=this._ranges[s];if(!(e>(l=i+(d.bottomRow-d.topRow)))){var u=e>i?d.topRow+(e-i):d.topRow,f=Math.min(d.bottomRow,u+t-1),p=arguments.length>2?r:d.leftCol,c=arguments.length>2?o:d.rightCol;n.push(new a(u,p,f,c));t-=f-u+1}}return new RowRange(n)};return RowRange}(),f=function(){function PdfPageRowRange(e,t,r){this._col=t;this._row=r;this._range=e}Object.defineProperty(PdfPageRowRange.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0});Object.defineProperty(PdfPageRowRange.prototype,"pageCol",{get:function(){return this._col},enumerable:!0,configurable:!0});Object.defineProperty(PdfPageRowRange.prototype,"pageRow",{get:function(){return this._row},enumerable:!0,configurable:!0});return PdfPageRowRange}()})((t=e.grid||(e.grid={})).pdf||(t.pdf={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var r,o="wj-pdf-fake-cell";function _removeFakeCell(){if(r){e.removeChild(r);r=null}}t._removeFakeCell=_removeFakeCell;var n=function(){function FlexGridPdfConverter(){}FlexGridPdfConverter.draw=function(e,t,r,o,n){this.drawToPosition(e,t,null,r,o,n)};FlexGridPdfConverter.drawToPosition=function(r,o,n,i,l,s){e.assert(!!r,"The flex argument cannot be null.");e.assert(!!o,"The doc argument cannot be null.");var a,d=t.softGrid()&&r instanceof t.softGrid().FlexGrid,u=r;try{s=t._FlexGridPdfCoreConverter._applyDefaultDrawSettings(s);var f=r;if(d){if(s&&s.recalculateStarWidths){a=u.columns.getTotalSize();u.columns._updateStarSizes(e.pdf.ptToPx(o.width))}f=this._getFlexGridAdapter(u,s)}t._FlexGridPdfCoreConverter.draw(f,o,n,i,l,s)}finally{_removeFakeCell();d&&s&&s.recalculateStarWidths&&u.columns._updateStarSizes(a)}};FlexGridPdfConverter.export=function(t,r,o){e.assert(!!t,"The flex argument cannot be null.");e.assert(!!r,"The fileName argument cannot be empty.");var n=(o=this._applyDefaultExportSettings(o)).documentOptions.ended;o.documentOptions.ended=function(t,l){o.progress&&o.progress(1);n&&!1===n.apply(i,[t,l])||e.pdf.saveBlob(l.blob,r);t.dispose()};var i=new e.pdf.PdfDocument(o.documentOptions);this.drawToPosition(t,i,null,null,null,o);i.end()};FlexGridPdfConverter._getFlexGridAdapter=function(e,r){return new(t.softMultiRow()&&e instanceof t.softMultiRow().MultiRow&&s||t.softSheet()&&e instanceof t.softSheet().FlexSheet&&l||t.softOlap()&&e instanceof t.softOlap().PivotGrid&&a||t.softTransposed()&&e instanceof t.softTransposed().TransposedGrid&&d||t.softTransposedMultiRow()&&e instanceof t.softTransposedMultiRow().TransposedMultiRow&&u||i)(e,r)};FlexGridPdfConverter._applyDefaultExportSettings=function(e){return t._merge(t._merge({},e),this._DefaultExportSettings)};FlexGridPdfConverter._DefaultExportSettings=t._merge({scaleMode:t.ScaleMode.PageWidth,documentOptions:{compress:!1,pageSettings:{margins:{left:36,right:36,top:18,bottom:18}}},_progressMax:.9},t._FlexGridPdfCoreConverter.DefaultDrawSettings);return FlexGridPdfConverter}();t.FlexGridPdfConverter=n;var i=function(){function FlexGridAdapter(e,t){this._defBorderColor=null;this._flex=e;this._settings=t;t.quickCellStyles&&(this._styleCache=new f(500))}Object.defineProperty(FlexGridAdapter.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"settings",{get:function(){return this._settings},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"columns",{get:function(){return this._flex.columns},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"rows",{get:function(){return this._flex.rows},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"bottomLeftCells",{get:function(){return this._flex.bottomLeftCells},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"cells",{get:function(){return this._flex.cells},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"columnFooters",{get:function(){return this._flex.columnFooters},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"columnHeaders",{get:function(){return this._flex.columnHeaders},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"rowHeaders",{get:function(){return this._flex.rowHeaders},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"topLeftCells",{get:function(){return this._flex.topLeftCells},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"treeIndent",{get:function(){return this._flex.treeIndent},enumerable:!0,configurable:!0});FlexGridAdapter.prototype.getSelection=function(){var e=[],r=this._flex.selection,o=t.softGrid();switch(this._flex.selectionMode){case o.SelectionMode.None:break;case o.SelectionMode.Cell:case o.SelectionMode.CellRange:e.push(new t._CellRange(r.row,r.col,r.row2,r.col2));break;case o.SelectionMode.Row:e.push(new t._CellRange(r.topRow,0,r.topRow,this._flex.cells.columns.length-1));break;case o.SelectionMode.RowRange:e.push(new t._CellRange(r.topRow,0,r.bottomRow,this._flex.cells.columns.length-1));break;case o.SelectionMode.ListBox:for(var n=-1,i=0;i<this._flex.rows.length;i++)if(this._flex.rows[i].isSelected){n<0&&(n=i);i===this._flex.rows.length-1&&e.push(new t._CellRange(n,0,i,this._flex.cells.columns.length-1))}else{n>=0&&e.push(new t._CellRange(n,0,i-1,this._flex.cells.columns.length-1));n=-1}}return e};FlexGridAdapter.prototype.getCell=function(e,n,i,l){var s=e.getCellElement(n,i);if(!s){s=function getFakeCell(e){if(!r){(r=document.createElement("div")).setAttribute(o,"true");t.softGrid()&&r.setAttribute(t.softGrid().FlexGrid._WJS_MEASURE,"true")}var n=r.style;n.cssText="";n.position="absolute";n.overflow="hidden";n.width="1px";n.height="1px";n.clipPath="inset(100%)";n.clip="rect(0 0 0 0)";var i=e.hostElement,l=i.children.length?i.children[0]:i;r.parentNode!==l&&l.appendChild(r);return r}(e);this._flex.cellFactory.updateCell(e,n,i,s,null,l)}return s};FlexGridAdapter.prototype.getComputedDefBorderColor=function(){if(null==this._defBorderColor){var e=window.getComputedStyle(this._flex.hostElement);this._defBorderColor="none"!=e.borderRightStyle?e.borderRightColor:"none"!=e.borderBottomStyle?e.borderBottomColor:"none"!=e.borderLeftStyle?e.borderLeftColor:"none"!=e.borderTopStyle?e.borderTopColor:"rgba(0,0,0,0.2)"}return this._defBorderColor};FlexGridAdapter.prototype.getComputedStyle=function(e,r){var n,i=null==r.getAttribute(o),l=r.className,s=l.indexOf("wj-state-selected")>=0||l.indexOf("wj-state-multi-selected")>=0;s&&(r.className=l.replace("wj-state-selected","").replace("wj-state-multi-selected",""));if(this._styleCache){var a=e.hostElement,d=r.style.cssText.split(/;\s+/).filter((function(e){var t=e.substring(0,e.indexOf(":"));return/^(color|background-color|border-color|border-left-color|border-right-color|border-top-color|border-bottom-color|font|textAlign)/i.test(t)})).join(";"),u=r;do{d=u.className+d}while(u!==a&&(u=u.parentElement));if(!(n=this._styleCache.getValue(d))){n=window.getComputedStyle(r);n=this._styleCache.add(d,n)}}else n=t._cloneStyle(window.getComputedStyle(r));i&&s&&(r.className=l);return n};FlexGridAdapter.prototype.getMergedRange=function(e,r,o){var n=this._flex.getMergedRange(e,r,o,!1);return n?new t._CellRange(n.row,n.col,n.row2,n.col2):null};Object.defineProperty(FlexGridAdapter.prototype,"showColumnHeader",{get:function(){return!!(this._flex.headersVisibility&t.softGrid().HeadersVisibility.Column)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"showRowHeader",{get:function(){return!!(this._flex.headersVisibility&t.softGrid().HeadersVisibility.Row)},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridAdapter.prototype,"showColumnFooter",{get:function(){return this._flex.columnFooters.rows.length>0},enumerable:!0,configurable:!0});FlexGridAdapter.prototype.alignMergedTextToTheTopRow=function(e){return!1};FlexGridAdapter.prototype.getCellData=function(e,t,r){return e.getCellData(t,r,!0)};FlexGridAdapter.prototype.getCellContent=function(r,o,n,i){var l,s=t.softGrid();if(this.settings.customCellContent){var a=this.getCell(r,o.index,i,!0);!(l=(l=a.innerText.trim()).replace(/\r/gm,"").replace(/\n+/gm,"\n"))&&this.isBooleanCell(r,o,n)&&(l=null==(l=this._extractCheckboxValue(a))?"":l+"")}else{var d=n.isContentHtml;l=this.getCellData(r,o.index,i);if(this.isGroupRow(o)&&r.cellType===s.CellType.Cell&&n.index===r.columns.firstVisibleIndex){d=!0;l||(l=o.getGroupHeader())}d&&(l=e.toPlainText(l).trim())}return l};FlexGridAdapter.prototype.isBooleanCell=function(r,o,n){return n.dataType===e.DataType.Boolean&&r.cellType===t.softGrid().CellType.Cell&&(!this.isExpandableGroupRow(o)||n.visibleIndex>0)};FlexGridAdapter.prototype.getColumn=function(e,t,r){return e.columns[r]};FlexGridAdapter.prototype.isAlternatingRow=function(e){var t=!1,r=this._flex.alternatingRowStep;if(r){t=e.visibleIndex%(r+1)==0;1==r&&(t=!t)}return t};FlexGridAdapter.prototype.isGroupRow=function(e){return e instanceof t.softGrid().GroupRow};FlexGridAdapter.prototype.isNewRow=function(e){return e instanceof t.softGrid()._NewRowTemplate};FlexGridAdapter.prototype.isDetailRow=function(e){return t.softDetail()&&e instanceof t.softDetail().DetailRow};FlexGridAdapter.prototype.isExpandableGroupRow=function(e){return e instanceof t.softGrid().GroupRow&&e.hasChildren};FlexGridAdapter.prototype.isRenderableRow=function(e){return e.isVisible&&e.renderHeight>0&&!this.isNewRow(e)};FlexGridAdapter.prototype.isRenderableColumn=function(e){return e.isVisible&&e.renderWidth>0};FlexGridAdapter.prototype.getCellStyle=function(e,r,o){var n=this.settings.styles,i=t._merge({},n.cellStyle),l=this._flex,s=t.softGrid();switch(e.cellType){case s.CellType.Cell:this.isExpandableGroupRow(r)?t._merge(i,n.groupCellStyle,!0):this.isAlternatingRow(r)&&t._merge(i,n.altCellStyle,!0);break;case s.CellType.ColumnHeader:case s.CellType.RowHeader:case s.CellType.TopLeft:case s.CellType.BottomLeft:t._merge(i,n.headerCellStyle,!0);break;case s.CellType.ColumnFooter:t._merge(i,n.headerCellStyle,!0);t._merge(i,n.footerCellStyle,!0)}!this.settings.customCellContent&&l._getShowErrors()&&l._getError(e,r.index,o.index)&&t._merge(i,n.errorCellStyle,!0);return i};FlexGridAdapter.prototype._extractCheckboxValue=function(e){var t=e.querySelector("input[type=checkbox]");if(t&&"none"!==t.style.display&&"hidden"!==t.style.visibility)return t.checked};return FlexGridAdapter}(),l=function(r){__extends(FlexSheetAdapter,r);function FlexSheetAdapter(){return null!==r&&r.apply(this,arguments)||this}FlexSheetAdapter.prototype.getCellData=function(e,o,n){return e.cellType===t.softGrid().CellType.Cell?e.rows[o]instanceof t.softSheet().HeaderRow?this.flex.columnHeaders.getCellData(o,n,!0):this.flex.getCellValue(o,n,!0):r.prototype.getCellData.call(this,e,o,n)};FlexSheetAdapter.prototype.getCellStyle=function(o,n,i){var l=r.prototype.getCellStyle.call(this,o,n,i),s=this.flex.selectedSheet.findTable(n.index,i.index);if(s){var a=s.getRange(),d=n.index-a.topRow,u=i.index-a.leftCol,f=s._getTableCellAppliedStyles(d,u);f&&(f.font=new e.pdf.PdfFont(f.fontFamily,e.pdf._asPt(f.fontSize,!0,void 0),f.fontStyle,f.fontWeight));t._merge(l,f,!0)}return l};Object.defineProperty(FlexSheetAdapter.prototype,"showColumnHeader",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(FlexSheetAdapter.prototype,"showRowHeader",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(FlexSheetAdapter.prototype,"showColumnFooter",{get:function(){return!1},enumerable:!0,configurable:!0});return FlexSheetAdapter}(i),s=function(e){__extends(MultiRowAdapter,e);function MultiRowAdapter(){return null!==e&&e.apply(this,arguments)||this}MultiRowAdapter.prototype.getColumn=function(r,o,n){var i=e.prototype.getColumn.call(this,r,o,n),l=this.flex.getBindingColumn(r,o,n);return t._combineColumns(i,l)};MultiRowAdapter.prototype.isAlternatingRow=function(r){if(r instanceof t.softMultiRow()._MultiRow){var o=!1,n=this.flex.alternatingRowStep;if(n){o=r.dataIndex%(n+1)==0;1==n&&(o=!o)}return o}return e.prototype.isAlternatingRow.call(this,r)};return MultiRowAdapter}(i),a=function(e){__extends(PivotGridAdapter,e);function PivotGridAdapter(){return null!==e&&e.apply(this,arguments)||this}PivotGridAdapter.prototype.alignMergedTextToTheTopRow=function(e){var r=t.softGrid();return!this.flex.centerHeadersVertically&&(e.cellType===r.CellType.ColumnHeader||e.cellType===r.CellType.RowHeader)};return PivotGridAdapter}(i),d=function(e){__extends(_TransposedGridAdapter,e);function _TransposedGridAdapter(){return null!==e&&e.apply(this,arguments)||this}_TransposedGridAdapter.prototype.getColumn=function(r,o,n){var i=e.prototype.getColumn.call(this,r,o,n);if(r.cellType!=t.softGrid().CellType.Cell)return i;var l=r.grid._getBindingColumn(r,o,i);return l?t._combineColumns(i,l):i};return _TransposedGridAdapter}(i),u=function(e){__extends(TransposedMultiRowAdapter,e);function TransposedMultiRowAdapter(){return null!==e&&e.apply(this,arguments)||this}TransposedMultiRowAdapter.prototype.getColumn=function(r,o,n){var i=e.prototype.getColumn.call(this,r,o,n);if(r.cellType!=t.softGrid().CellType.Cell)return i;var l=this.flex.getBindingColumn(r,o,n);return l?t._combineColumns(i,l):i};return TransposedMultiRowAdapter}(i),f=function(){function StyleCache(e){this._cache={};this._size=0;this._max=e}StyleCache.prototype.add=function(e,r){this._size>=this._max&&this.clear();var o=this._cache[e]=t._cloneStyle(r);this._size++;return o};StyleCache.prototype.clear=function(){this._cache={};this._size=0};StyleCache.prototype.getValue=function(e){return this._cache[e]||null};StyleCache.prototype.hasKey=function(e){return!!this._cache[e]};return StyleCache}()})((t=e.grid||(e.grid={})).pdf||(t.pdf={}))}(wijmo||(wijmo={}));!function(e){var t;(function(t){"use strict";var r;!function(e){e[e.Done=1]="Done";e[e.Progress=2]="Progress"}(r||(r={}));var o=function(e){__extends(PdfWebWorkerExportDoneEventArgs,e);function PdfWebWorkerExportDoneEventArgs(t){var r=e.call(this)||this;r._buf=t;return r}Object.defineProperty(PdfWebWorkerExportDoneEventArgs.prototype,"blob",{get:function(){this._blob||(this._blob=new Blob([new Uint8Array(this._buf)],{type:"application/pdf"}));return this._blob},enumerable:!0,configurable:!0});Object.defineProperty(PdfWebWorkerExportDoneEventArgs.prototype,"buffer",{get:function(){return this._buf},enumerable:!0,configurable:!0});return PdfWebWorkerExportDoneEventArgs}(e.EventArgs);t.PdfWebWorkerExportDoneEventArgs=o;var n=function(){function PdfWebWorkerClient(){}PdfWebWorkerClient.exportGrid=function(r,o,n,i,l,s){(i=t.FlexGridPdfConverter._applyDefaultExportSettings(i)).progress=i.progress||s;this.addGrid(r,o,"",i);this.export(r,i.documentOptions,(function(t){e.isFunction(l)&&!1===l(t)||e.pdf.saveBlob(t.blob,n)}),s)};PdfWebWorkerClient.export=function(t,n,i,l){t.addEventListener("message",(function handler(n){var s=n.data;switch(s.status){case r.Done:t.removeEventListener("message",handler);e.isFunction(i)&&i(new o(s.data));break;case r.Progress:l&&l(s.data);break;default:throw"Unknown status: "+s.status}}));var s=this._clientDataToArrayBuffer(t);t.postMessage({content:s,settings:n},[s]);this._clearClientData(t)};PdfWebWorkerClient.addGrid=function(e,t,r,o){var n=this._gridToJson(t,o);this._addClientData(e,JSON.stringify(n),r,o,!0)};PdfWebWorkerClient.addImage=function(t,r,o,n){var i=e.isString(r)&&r.indexOf("data:image/svg")>=0?r:e.pdf._PdfImageHelper.getDataUri(r);this._addClientData(t,i,o,n)};PdfWebWorkerClient.addString=function(e,t,r){this._addClientData(e,t,r,null)};PdfWebWorkerClient.serializeGrid=function(e,t){var r=this._gridToJson(e,t);return strToBuf(JSON.stringify(r))};PdfWebWorkerClient._addClientData=function(t,r,o,n,i){void 0===i&&(i=!1);e.asType(t,Worker);e.asString(o);e.asString(r,!0);var l=t;l.clientData=l.clientData||{};l.clientData[o]={content:r,settings:n?JSON.stringify(n):null};var s=l.clientData[o];if(i){s.isGrid=!0;s.progressMessaging=!!n&&e.isFunction(n.progress)}};PdfWebWorkerClient._clearClientData=function(e){delete e.clientData};PdfWebWorkerClient._clientDataToArrayBuffer=function(e){var t=e;return strToBuf(JSON.stringify(t.clientData||{}))};PdfWebWorkerClient._gridToJson=function(r,o){o=t.FlexGridPdfConverter._applyDefaultExportSettings(o);var n,i;try{n=new e.pdf.PdfDocument(o.documentOptions);if(o&&o.recalculateStarWidths){i=r.columns.getTotalSize();r.columns._updateStarSizes(e.pdf.ptToPx(n.width))}return this._getJsonConverter(r,o).convert()}finally{t._removeFakeCell();o&&o.recalculateStarWidths&&r.columns._updateStarSizes(i);if(null!=n){n.dispose();n=null}}};PdfWebWorkerClient._getJsonConverter=function(e,r){return new(t.softMultiRow()&&e instanceof t.softMultiRow().MultiRow&&d||t.softOlap()&&e instanceof t.softOlap().PivotGrid&&u||t.softTransposed()&&e instanceof t.softTransposed().TransposedGrid&&f||t.softTransposedMultiRow()&&e instanceof t.softTransposedMultiRow().TransposedMultiRow&&p||a)(e,r,t.FlexGridPdfConverter._getFlexGridAdapter(e,r))};return PdfWebWorkerClient}();t.PdfWebWorkerClient=n;var i,l,s=function(){function PdfWebWorker(){}PdfWebWorker.initExportGrid=function(){var e=this;this.initExport((function(r,o){var n=o[""];if(n.progressMessaging){n.settings._progressMax=t.FlexGridPdfConverter._DefaultExportSettings._progressMax;n.settings.progress=function(t){e.sendExportProgress(t)};r.ended.addHandler((function(){e.sendExportProgress(1)}))}t.FlexGridPdfConverter.draw(n.content,r,null,null,n.settings);r.end()}))};PdfWebWorker.initExport=function(t){self.addEventListener("message",(function handler(o){self.removeEventListener("message",handler);var n=o.data,i=JSON.parse(bufToStr(n.content)),l=n.settings||{};l.ended=function(t,o){!function blobToBuf(t,r){e.asFunction(r);var o=new FileReader;o.onload=function(e){r(e.target.result)};o.readAsArrayBuffer(t)}(o.blob,(function(e){self.postMessage({data:e,status:r.Done},[e])}))};var s=new e.pdf.PdfDocument(l);Object.keys(i).forEach((function(e){var t=i[e];t.settings&&(t.settings=JSON.parse(t.settings));if(t.isGrid){t.settings&&PdfWebWorker._disableUnsupportedFeatures(t.settings);t.content=PdfWebWorker._deserializeGridFromString(t.content,t.settings)}}));t(s,i)}))};PdfWebWorker.sendExportProgress=function(t){t=e.clamp(t,0,1);self.postMessage({data:t,status:r.Progress})};PdfWebWorker.deserializeGrid=function(e,t){return this._deserializeGridFromString(bufToStr(e),t)};PdfWebWorker._deserializeGridFromString=function(e,r){return this._getJsonAdapter(JSON.parse(e),t.FlexGridPdfConverter._applyDefaultExportSettings(r))};PdfWebWorker._disableUnsupportedFeatures=function(e){e.customCellContent=!1};PdfWebWorker._getJsonAdapter=function(e,t){switch(e.typeName){case"MultiRow":return new y(e,t);case"PivotGrid":return new b(e,t);case"TransposedGrid":return new R(e,t);case"TransposedMultiRow":return new x(e,t);default:return new m(e,t)}};return PdfWebWorker}();t.PdfWebWorker=s;function bufToStr(e){for(var t=new Uint16Array(e),r="",o=0,n=t.length;o<n;o++)r+=String.fromCharCode(t[o]);return r}function strToBuf(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),o=0,n=e.length;o<n;o++)r[o]=e.charCodeAt(o);return t}!function(e){e[e.None=0]="None";e[e.Alternate=1]="Alternate";e[e.Group=2]="Group";e[e.ExpandableGroup=4]="ExpandableGroup";e[e.New=8]="New";e[e.Visible=16]="Visible";e[e.Detail=32]="Detail"}(i||(i={}));!function(e){e[e.None=0]="None";e[e.Visible=1]="Visible"}(l||(l={}));var a=function(){function FlexGridJsonConverter(e,t,r){this._flex=e;this._settings=t;this._adapter=r}FlexGridJsonConverter.prototype.convert=function(){var e={};e.typeName=this._getTypeName(this._flex);e.selection=this._serializeSelection();e.showColumnFooter=this.adapter.showColumnFooter;e.showColumnHeader=this.adapter.showColumnHeader;e.showRowHeader=this.adapter.showRowHeader;e.treeIndent=this._flex.treeIndent;e.bottomLeftCells=this._serializePanel(this._flex.bottomLeftCells);e.cells=this._serializePanel(this._flex.cells);e.columnFooters=this._serializePanel(this._flex.columnFooters);e.columnHeaders=this._serializePanel(this._flex.columnHeaders);e.rowHeaders=this._serializePanel(this._flex.rowHeaders);e.topLeftCells=this._serializePanel(this._flex.topLeftCells);return e};Object.defineProperty(FlexGridJsonConverter.prototype,"adapter",{get:function(){return this._adapter},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridJsonConverter.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0});FlexGridJsonConverter.prototype._getTypeName=function(e){return e.constructor.toString().match(/function\s*(\w+)/)[1]};FlexGridJsonConverter.prototype._getRowState=function(e){var r=i.None;this.adapter.isAlternatingRow(e)&&(r|=i.Alternate);e instanceof t.softGrid().GroupRow&&(r|=i.Group);this.adapter.isDetailRow(e)&&(r|=i.Detail);this.adapter.isExpandableGroupRow(e)&&(r|=i.ExpandableGroup);e instanceof t.softGrid()._NewRowTemplate&&(r|=i.New);e.isVisible&&(r|=i.Visible);return r};FlexGridJsonConverter.prototype._getColumnState=function(e){var t=l.None;e.isVisible&&(t|=l.Visible);return t};FlexGridJsonConverter.prototype._serializeSelection=function(){for(var e=this.adapter.getSelection(),t=[],r=0;r<e.length;r++){var o=e[r];t.push([o.row,o.col,o.row2,o.col2])}return t};FlexGridJsonConverter.prototype._serializeColumns=function(e){for(var t=[],r=0,o=(e||[]).length;r<o;r++){var n=e[r],i=null;if(n){i={aggregate:n.aggregate,renderWidth:n.renderWidth,visibleIndex:n.visibleIndex};var s=n.getAlignment();s&&(i.alignment=s);var a=this._getColumnState(n);a!==l.None&&(i.state=a);n.binding&&(i.binding=n.binding);null!=n.dataType&&(i.dataType=n.dataType);null!=n.name&&(i.name=n.name);n.wordWrap&&(i.wordWrap=!0);n.multiLine&&(i.multiLine=!0)}t.push(i)}return t};FlexGridJsonConverter.prototype._serializePanel=function(r){var o=this,n={cellType:r.cellType,height:r.height,width:r.width};n.mergedRanges=this._serializeMergedRanges(r);n.columns=this._serializeColumns(r.columns);n.columnsFirstVisibleIndex=r.columns.firstVisibleIndex;n.rows=[];n.rowsMaxGroupLevel=r.rows.maxGroupLevel;for(var l=!this._settings.customCellContent&&this._flex._getShowErrors(),_loop_1=function(a,d,u){var f=r.rows[a],p={renderHeight:f.renderHeight};n.rows.push(p);var c=function(t){if(t.align)return t.align;if(!t.dataMap)switch(t.dataType){case e.DataType.Boolean:return"center";case e.DataType.Number:return"right"}return null}(f);c&&(p.alignment=c);f instanceof t.softGrid().GroupRow&&(p.level=f.level);var h=s._getRowState(f);h!==i.None&&(p.state=h);f.binding&&(p.binding=f.binding);null!=f.dataType&&(p.dataType=f.dataType);f.wordWrap&&(p.wordWrap=!0);f.multiLine&&(p.multiLine=!0);p.cells=[];for(var g=t.softGrid(),_loop_2=function(n){var i=s._adapter.getCellContent(r,r.rows[a],r.columns[n],n);if(e.isFunction(s._settings.formatItem)){var d=new t.PdfFormatItemEventArgs(r,new g.CellRange(a,n),null,null,null,null,null,(function(){return o._adapter.getCell(r,a,n,!0)}),null);d.data=i;s._settings.formatItem(d);d.data!==i&&(i=d.data)}p.cells[n]=i;if(l&&s._flex._getError(r,a,n)){p.errors||(p.errors={});p.errors[n]=1}},_=0;_<u;_++)_loop_2(_)},s=this,a=0,d=r.rows.length,u=r.columns.length;a<d;a++)_loop_1(a,0,u);return n};FlexGridJsonConverter.prototype._serializeMergedRanges=function(e){for(var t=[],r=[],o=0;o<e.columns.length;o++)r[o]=0;for(var n=0;n<e.rows.length;n++)for(var i=0;i<e.columns.length;i++)if(!(n<r[i])){var l=e.grid.getMergedRange(e,n,i);if(null!=l&&!l.isSingleCell){t.push([l.row,l.col,l.row2,l.col2]);for(var s=l.col;s<=l.col2;s++)r[s]=l.row2+1;l.col===l.col2||(i=l.col2)}}return t};return FlexGridJsonConverter}(),d=function(e){__extends(MultiRowJsonConverter,e);function MultiRowJsonConverter(){return null!==e&&e.apply(this,arguments)||this}MultiRowJsonConverter.prototype.convert=function(){var t=e.prototype.convert.call(this);t.rowsPerItem=this.flex.rowsPerItem;return t};MultiRowJsonConverter.prototype._serializePanel=function(t){var r=e.prototype._serializePanel.call(this,t);r.cellGroups=this._serializeCellGroup(t);return r};MultiRowJsonConverter.prototype._serializeCellGroup=function(e){var r=[],o=[],n=t.softGrid(),i=this.flex.rowsPerItem;e.cellType!==n.CellType.TopLeft&&e.cellType!==n.CellType.ColumnHeader||(i=e.rows.length);for(var l=0;l<i;l++){o[l]=[];for(var s=0;s<e.columns.length;s++){var a=this.flex.getBindingColumn(e,l,s),d=r.indexOf(a);o[l][s]=d<0?r.push(a)-1:d}}return{bindingColumns:this._serializeColumns(r),mappings:o}};return MultiRowJsonConverter}(a),u=function(e){__extends(PivotGridJsonConverter,e);function PivotGridJsonConverter(){return null!==e&&e.apply(this,arguments)||this}PivotGridJsonConverter.prototype.convert=function(){var t=e.prototype.convert.call(this);t.centerHeadersVertically=this.flex.centerHeadersVertically;return t};return PivotGridJsonConverter}(a),f=function(e){__extends(TransposedGridJsonConverter,e);function TransposedGridJsonConverter(){return null!==e&&e.apply(this,arguments)||this}TransposedGridJsonConverter.prototype.convert=function(){for(var r=e.prototype.convert.call(this),o=new Array(this.flex.cells.rows.length),n=this.flex.cells,i=t.softGrid(),l=0,s=n.rows.length;l<s;l++){var a=n.rows[l].dataItem,d=a&&a._rowInfo;d instanceof i.Column||(d=t._combineColumns(d,d));o[l]=d}r.rowInfo=this._serializeColumns(o);return r};return TransposedGridJsonConverter}(a),p=function(e){__extends(TransposedMultirowJsonConverter,e);function TransposedMultirowJsonConverter(){return null!==e&&e.apply(this,arguments)||this}TransposedMultirowJsonConverter.prototype.convert=function(){var t=e.prototype.convert.call(this);t.cellGroups=this._serializeCellGroup();t.columnsPerItem=this.flex.columnsPerItem;return t};TransposedMultirowJsonConverter.prototype._serializeCellGroup=function(){for(var e=[],t=[],r=this.flex.columnsPerItem,o=this.flex.cells,n=0;n<o.rows.length;n++){t[n]=[];for(var i=0;i<r;i++){var l=this.flex.getBindingColumn(o,n,i),s=e.indexOf(l);t[n][i]=s<0?e.push(l)-1:s}}return{bindingColumns:this._serializeColumns(e),mappings:t}};return TransposedMultirowJsonConverter}(a),c=function(){function RowJson(e,t){this.index=t;this.binding=e.binding;this.dataType=e.dataType;this.alignment=e.alignment;this.level=e.level;this.renderHeight=e.renderHeight;this.cells=e.cells;this.wordWrap=e.wordWrap||!1;this.multiLine=e.multiLine||!1;this.errors=e.errors;this._state=e.state}Object.defineProperty(RowJson.prototype,"isAlternatingRow",{get:function(){return(this._state&i.Alternate)!==i.None},enumerable:!0,configurable:!0});Object.defineProperty(RowJson.prototype,"isGroupRow",{get:function(){return(this._state&i.Group)!==i.None},enumerable:!0,configurable:!0});Object.defineProperty(RowJson.prototype,"isDetailRow",{get:function(){return(this._state&i.Detail)!==i.None},enumerable:!0,configurable:!0});Object.defineProperty(RowJson.prototype,"isExpandableGroupRow",{get:function(){return(this._state&i.ExpandableGroup)!==i.None},enumerable:!0,configurable:!0});Object.defineProperty(RowJson.prototype,"isNewRow",{get:function(){return(this._state&i.New)!==i.None},enumerable:!0,configurable:!0});Object.defineProperty(RowJson.prototype,"isVisible",{get:function(){return(this._state&i.Visible)!==i.None},enumerable:!0,configurable:!0});return RowJson}(),h=function(){function ColumnJson(e,t){this.index=t;this.binding=e.binding;this.dataType=e.dataType;this.aggregate=e.aggregate;this.name=e.name;this.renderWidth=e.renderWidth;this.visibleIndex=e.visibleIndex;this.wordWrap=e.wordWrap||!1;this.multiLine=e.multiLine||!1;this._alignment=e.alignment;this._state=e.state}ColumnJson.prototype.getAlignment=function(e){return this._alignment?this._alignment:e&&e.alignment?e.alignment:""};Object.defineProperty(ColumnJson.prototype,"isVisible",{get:function(){return(this._state&l.Visible)!==l.None},enumerable:!0,configurable:!0});return ColumnJson}(),g=function g(e,t){void 0===t&&(t=-1);this.maxGroupLevel=t;this.length=e.length;for(var r=0;r<e.length;r++)this[r]=new c(e[r],r)},_=function _(e,t){void 0===t&&(t=-1);this.firstVisibleIndex=t;this.length=e.length;for(var r=0;r<e.length;r++){var o=e[r];this[r]=o?new h(e[r],r):null}},w=function(){function GridJsonPanel(e){this.height=e.height;this.width=e.width;this.cellType=e.cellType;this.columns=new _(e.columns,e.columnsFirstVisibleIndex);this.rows=new g(e.rows,e.rowsMaxGroupLevel);this._mergedRanges=this._deserializeMergedRanges(e.mergedRanges)}GridJsonPanel.prototype.getCellData=function(e,t){return this.rows[e].cells[t]};GridJsonPanel.prototype.getMergedRange=function(e,t){var r=this._mergedRanges[e];if(r)for(var o=0,n=r.length;o<n;o++){var i=r[o];if(t>=i.col&&t<=i.col2)return i}return null};GridJsonPanel.prototype._deserializeMergedRanges=function(e){var r=[];e=e||[];for(var o=0,n=this.rows.length;o<n;o++)r[o]=[];for(o=0,n=e.length;o<n;o++)for(var i=e[o],l=new t._CellRange(i[0],i[1],i[2],i[3]),s=l.row;s<=l.row2;s++)r[s].push(l);return r};return GridJsonPanel}(),m=function(){function FlexGridJsonAdapter(e,r){this.settings=r;this.bottomLeftCells=this.deserializePanel(e.bottomLeftCells);this.cells=this.deserializePanel(e.cells);this.columnFooters=this.deserializePanel(e.columnFooters);this.columnHeaders=this.deserializePanel(e.columnHeaders);this.rowHeaders=this.deserializePanel(e.rowHeaders);this.topLeftCells=this.deserializePanel(e.topLeftCells);this.treeIndent=e.treeIndent;this.showColumnFooter=e.showColumnFooter;this.showColumnHeader=e.showColumnHeader;this.showRowHeader=e.showRowHeader;this._selection=[];for(var o=0;o<e.selection.length;o++){var n=e.selection[o];this._selection.push(new t._CellRange(n[0],n[1],n[2],n[3]))}}Object.defineProperty(FlexGridJsonAdapter.prototype,"columns",{get:function(){return this.cells.columns},enumerable:!0,configurable:!0});Object.defineProperty(FlexGridJsonAdapter.prototype,"rows",{get:function(){return this.cells.rows},enumerable:!0,configurable:!0});FlexGridJsonAdapter.prototype.getSelection=function(){return this._selection};FlexGridJsonAdapter.prototype.getCell=function(e,t,r,o){throw"Not implemented"};FlexGridJsonAdapter.prototype.getComputedDefBorderColor=function(){throw"Not implemented"};FlexGridJsonAdapter.prototype.getComputedStyle=function(e,t){throw"Not implemented"};FlexGridJsonAdapter.prototype.getMergedRange=function(e,t,r){return e.getMergedRange(t,r)};FlexGridJsonAdapter.prototype.alignMergedTextToTheTopRow=function(e){return!1};FlexGridJsonAdapter.prototype.getCellData=function(e,t,r){return e.getCellData(t,r)};FlexGridJsonAdapter.prototype.getCellContent=function(e,t,r,o){return this.getCellData(e,t.index,o)};FlexGridJsonAdapter.prototype.isBooleanCell=function(r,o,n){return n.dataType===e.DataType.Boolean&&r.cellType===t._CellType.Cell&&!this.isExpandableGroupRow(o)};FlexGridJsonAdapter.prototype.getColumn=function(e,t,r){return e.columns[r]};FlexGridJsonAdapter.prototype.isAlternatingRow=function(e){return e.isAlternatingRow};FlexGridJsonAdapter.prototype.isGroupRow=function(e){return e.isGroupRow};FlexGridJsonAdapter.prototype.isNewRow=function(e){return e.isNewRow};FlexGridJsonAdapter.prototype.isDetailRow=function(e){return e.isDetailRow};FlexGridJsonAdapter.prototype.isExpandableGroupRow=function(e){return e.isExpandableGroupRow};FlexGridJsonAdapter.prototype.isRenderableRow=function(e){return e.isVisible&&e.renderHeight>0&&!this.isNewRow(e)};FlexGridJsonAdapter.prototype.isRenderableColumn=function(e){return e.isVisible&&e.renderWidth>0};FlexGridJsonAdapter.prototype.getCellStyle=function(e,r,o){var n=this.settings.styles,i=t._merge({},n.cellStyle);switch(e.cellType){case t._CellType.Cell:this.isExpandableGroupRow(r)?t._merge(i,n.groupCellStyle,!0):this.isAlternatingRow(r)&&t._merge(i,n.altCellStyle,!0);break;case t._CellType.ColumnHeader:case t._CellType.RowHeader:case t._CellType.TopLeft:case t._CellType.BottomLeft:t._merge(i,n.headerCellStyle,!0);break;case t._CellType.ColumnFooter:t._merge(i,n.headerCellStyle,!0);t._merge(i,n.footerCellStyle,!0)}r.errors&&r.errors[o.index]&&t._merge(i,n.errorCellStyle,!0);return i};FlexGridJsonAdapter.prototype.deserializePanel=function(e){return new w(e)};return FlexGridJsonAdapter}(),b=function(e){__extends(PivotGridJsonAdapter,e);function PivotGridJsonAdapter(t,r){var o=e.call(this,t,r)||this;o._centerHeadersVertically=t.centerHeadersVertically;return o}PivotGridJsonAdapter.prototype.alignMergedTextToTheTopRow=function(e){return!this._centerHeadersVertically&&(e.cellType===t._CellType.ColumnHeader||e.cellType===t._CellType.RowHeader)};return PivotGridJsonAdapter}(m),C=function(e){__extends(MultiRowJsonPanel,e);function MultiRowJsonPanel(t){var r=e.call(this,t)||this;t.cellGroups&&(r._cellGroups={bindingColumns:new _(t.cellGroups.bindingColumns),mappings:t.cellGroups.mappings});return r}MultiRowJsonPanel.prototype.getColumn=function(e,r,o){var n=this.columns[r];if(this._cellGroups){this.cellType!==t._CellType.ColumnHeader&&this.cellType!==t._CellType.BottomLeft&&(e%=o);var i=this._cellGroups.bindingColumns[this._cellGroups.mappings[e][r]];return t._combineColumns(n,i)}return n};return MultiRowJsonPanel}(w),y=function(e){__extends(MultiRowJsonAdapter,e);function MultiRowJsonAdapter(t,r){var o=e.call(this,t,r)||this;o._rowsPerItem=t.rowsPerItem;return o}MultiRowJsonAdapter.prototype.deserializePanel=function(e){return new C(e)};MultiRowJsonAdapter.prototype.getColumn=function(e,t,r){return e.getColumn(t,r,this._rowsPerItem)};return MultiRowJsonAdapter}(m),R=function(e){__extends(TransposedGridJsonAdapter,e);function TransposedGridJsonAdapter(t,r){var o=e.call(this,t,r)||this;o._rowInfo=new _(t.rowInfo);return o}TransposedGridJsonAdapter.prototype.getColumn=function(r,o,n){var i=e.prototype.getColumn.call(this,r,o,n);if(r.cellType!==t._CellType.Cell)return i;var l=this._rowInfo[o];return l?t._combineColumns(i,l):i};return TransposedGridJsonAdapter}(m),x=function(e){__extends(TransposedMultiRowJsonAdapter,e);function TransposedMultiRowJsonAdapter(t,r){var o=e.call(this,t,r)||this;o._columnsPerItem=t.columnsPerItem;t.cellGroups&&(o._cellGroups={bindingColumns:new _(t.cellGroups.bindingColumns),mappings:t.cellGroups.mappings});return o}TransposedMultiRowJsonAdapter.prototype.getColumn=function(r,o,n){var i=e.prototype.getColumn.call(this,r,o,n);if(this._cellGroups&&r.cellType===t._CellType.Cell){n%=this._columnsPerItem;var l=this._cellGroups.bindingColumns[this._cellGroups.mappings[o][n]];return t._combineColumns(i,l)}return i};return TransposedMultiRowJsonAdapter}(m)})((t=e.grid||(e.grid={})).pdf||(t.pdf={}))}(wijmo||(wijmo={}));!function(e){!function(t){t.pdf||(t.pdf={}),e._registerModule("wijmo.grid.pdf",e.grid.pdf)}(e.grid||(e.grid={}))}(wijmo||(wijmo={}));